import{k as ae,l as le,q as d,v as j,r as f,o as s,c as a,w as c,T as q,x as z,g as u,a as n,t as l,b as m,A as G,F as I,u as r,D as O,E as J,e as _,f as R,h as K,G as ce,p as re,j as ie}from"./index.944eba06.js";import{T as Q,d as W}from"./dayjs.min.b670377a.js";import{_ as i}from"./TokenIcon.vuevuetypestyleindex0scoped7bbb7138lang.fec3cb16.js";import{_ as de}from"./plugin-vueexport-helper.2444895f.js";const ue=C=>(re("data-v-9dc789cf"),C=C(),ie(),C),ve={class:"text"},pe={class:"item-left"},fe={class:"left-content"},_e={class:"bottom-text"},he={class:"item-right"},ye={key:0,class:"bottom-text"},ke=["onClick"],ge={key:1,class:"bottom-text"},me=["onClick"],Ce={class:"text"},we={class:"item-left"},xe={class:"left-content"},be=["onClick"],Le={class:"bottom-text"},$e={class:"item-right"},Ie={class:"status-icon"},Ae={class:"content"},He={class:"bottom-text"},Te=ue(()=>n("span",null,"/",-1)),Ue={__name:"History",setup(C){const A=ae(),w=le(),h=d(0),x=d(20),y=d([]),H=d(1),T=d(!1),k=d([]),V=d(1),b=d(!1),p=d(!1),L=d(!1),v=d(!1),U=d(!1),X=j([{name:"\u7EE7\u7EED\u8F6C\u53D1",value:"0",color:"#3F80F7"},{name:"\u67E5\u770B\u624B\u6C14",value:"1"}]),g=j({creatorAddress:"",showLuckUrl:"",redPacketUrl:""});function Z(o){o.refundTx==""&&o.unlockTx==""&&(U.value=!0,g.creatorAddress=R(o.creatorAddress)+"\u53D1\u51FA\u7684\u7EA2\u5305",g.showLuckUrl="/redpacket/"+o.uuid+"/showLuck",g.redPacketUrl="/redpacket/"+o.uuid)}function ee(o){o.value==0?A.push(g.redPacketUrl):o.value==1&&A.push(g.showLuckUrl)}function te(o){window.open("https://testnet.bscscan.com/tx/"+o,"_blank")}function oe(){S()}function Y(){h.value==0?(H.value=1,y.value=[],M()):h.value==1&&(b.value=!1,k.value=[],P())}function S(){h.value==0?M():h.value==1&&P()}async function M(){p.value=!0;let o=q.loading({message:"Loading...",forbidClick:!0,duration:0});try{const t=await z.redPacket.getReceiveHistory(w.walletAddress,x.value,H.value);console.log(t),t.status==1?(console.log(y),y.value=y.value.concat(t.data.list),t.data.list.length<x.value?L.value=!0:H.value++):(console.log("fail"),v.value=!0)}catch(t){console.log(t),v.value=!0}finally{console.log(v.value),o.clear(),T.value=!1,p.value=!1}}async function P(){p.value=!0;let o=q.loading({message:"Loading...",forbidClick:!0,duration:0});try{const t=await z.redPacket.getSendHistory(w.walletAddress,x.value,V.value);console.log(t),t.status==1?(console.log(k),k.value=k.value.concat(t.data.list),t.data.list.length<x.value?L.value=!0:V.value++):(console.log("fail"),v.value=!0)}catch(t){console.log(t),v.value=!1}finally{console.log(v.value),o.clear(),b.value=!1,p.value=!1}}return(o,t)=>{const D=f("van-empty"),F=f("van-cell"),N=f("van-list"),B=f("van-pull-refresh"),E=f("van-tab"),se=f("van-action-sheet"),ne=f("van-tabs");return s(),a(ne,{class:"history",active:h.value,"onUpdate:active":t[7]||(t[7]=e=>h.value=e),onRendered:oe},{default:c(()=>[u(E,{class:"tab-top",title:o.$t("ireceived")},{default:c(()=>[u(B,{modelValue:T.value,"onUpdate:modelValue":t[2]||(t[2]=e=>T.value=e),onRefresh:Y},{default:c(()=>[y.value.length==0?(s(),a(D,{key:0,class:"empty-box"},{image:c(()=>[u(i,{class:"icon",name:"emptyHistory"}),n("div",ve,l(o.$t("noRecord")),1)]),_:1})):(s(),a(N,{key:1,loading:p.value,"onUpdate:loading":t[0]||(t[0]=e=>p.value=e),finished:L.value,"finished-text":o.$t("noMore"),error:v.value,"onUpdate:error":t[1]||(t[1]=e=>v.value=e),"error-text":o.$t("errorText"),onLoad:S},{default:c(()=>[(s(!0),m(I,null,G(y.value,e=>(s(),a(F,{class:"receive-item item",key:e},{title:c(()=>[n("div",pe,[u(Q,{chainIcon:r(O)(e.contractChain),tokenIcon:r(J)(e.contractChain.toLowerCase(),e.contractAddress.toLowerCase())},null,8,["chainIcon","tokenIcon"]),n("div",fe,[n("div",null,[_(l(r(R)(e.userAddress)),1),u(i,{class:"copy-icon",name:"copy",onClick:$=>r(K)(e.userAddress)},null,8,["onClick"])]),n("div",_e,[e.type==0?(s(),a(i,{key:0,class:"type-icon",name:"pin"})):(s(),a(i,{key:1,class:"type-icon",name:"pu"})),_(" "+l(r(W).unix(e.time).format("YYYY-MM-DD HH:mm")),1)])])])]),value:c(()=>[n("div",he,[n("div",null,l(e.amount)+" "+l(e.symbol),1),e.tx?(s(),m("div",ye,[n("span",{onClick:$=>te(e.tx)},[_(l(o.$t("Blockchain browser")),1),u(i,{class:"share-icon",name:"share"})],8,ke)])):(s(),m("div",ge,[n("span",{onClick:$=>r(A).push(`/redpacket/${e.uuid}/showLuck`)},l(o.$t("seeLuck")),9,me)]))])]),_:2},1024))),128))]),_:1},8,["loading","finished","finished-text","error","error-text"]))]),_:1},8,["modelValue"])]),_:1},8,["title"]),u(E,{title:o.$t("isend")},{default:c(()=>[u(B,{modelValue:b.value,"onUpdate:modelValue":t[5]||(t[5]=e=>b.value=e),onRefresh:Y},{default:c(()=>[k.value.length==0?(s(),a(D,{key:0,class:"empty-box"},{image:c(()=>[u(i,{class:"icon",name:"emptyHistory"}),n("div",Ce,l(o.$t("noRecord")),1)]),_:1})):(s(),a(N,{key:1,loading:p.value,"onUpdate:loading":t[3]||(t[3]=e=>p.value=e),finished:L.value,"finished-text":o.$t("noMore"),error:v.value,"onUpdate:error":t[4]||(t[4]=e=>v.value=e),"error-text":o.$t("errorText"),onLoad:S},{default:c(()=>[(s(!0),m(I,null,G(k.value,e=>(s(),a(F,{class:"send-item item",key:e,onClick:$=>Z(e)},{title:c(()=>[n("div",we,[u(Q,{chainIcon:r(O)(e.contractChain),tokenIcon:r(J)(e.contractChain.toLowerCase(),e.contractAddress.toLowerCase())},null,8,["chainIcon","tokenIcon"]),n("div",xe,[n("div",{onClick:ce($=>r(K)(e.creatorAddress),["stop"])},[_(l(r(R)(e.creatorAddress)),1),u(i,{class:"copy-icon",name:"copy"})],8,be),n("div",Le,[e.type==0?(s(),a(i,{key:0,class:"type-icon",name:"pin"})):(s(),a(i,{key:1,class:"type-icon",name:"pu"})),_(" "+l(r(W)(e.createTime).format("YYYY-MM-DD HH:mm")),1)])])])]),value:c(()=>[n("div",$e,[n("div",Ie,[e.refundTx!=""||e.unlockTx!=""?(s(),m(I,{key:0},[r(w).language=="en"?(s(),a(i,{key:0,class:"type-icon",name:"endEn"})):(s(),a(i,{key:1,class:"type-icon",name:"endCn"}))],64)):(s(),m(I,{key:1},[r(w).language=="en"?(s(),a(i,{key:0,class:"type-icon",name:"goingEn"})):(s(),a(i,{key:1,class:"type-icon",name:"goingCn"}))],64))]),n("div",Ae,[n("div",null,l(e.totalAmount+" "+e.symbol),1),n("div",He,[_(l(o.$t("received"))+" "+l(e.receivedCount),1),Te,_(l(e.count),1)])])])]),_:2},1032,["onClick"]))),128))]),_:1},8,["loading","finished","finished-text","error","error-text"]))]),_:1},8,["modelValue"])]),_:1},8,["title"]),u(se,{show:U.value,"onUpdate:show":t[6]||(t[6]=e=>U.value=e),actions:X,"cancel-text":"\u53D6\u6D88",description:g.creatorAddress,"close-on-click-action":"",onSelect:ee},null,8,["show","actions","description"])]),_:1},8,["active"])}}},Me=de(Ue,[["__scopeId","data-v-9dc789cf"]]);export{Me as default};
