import{k as te,l as se,m as n,q as oe,r as _,o,c,w as a,T as z,s as B,g as l,b as C,x as P,F as j,a as s,e as p,t as r,u as v,f as q,h as E,z as O,A as ae,C as ne,p as le,j as ce}from"./index.4ee347b9.js";import{T as ie}from"./TokenIcon.acce3039.js";import{_ as i}from"./TokenIcon.vue_vue_type_style_index_0_scoped_7bbb7138_lang.7a46c07c.js";import{_ as re}from"./_plugin-vue_export-helper.cdc0426e.js";const S=g=>(le("data-v-0276e8a9"),g=g(),ce(),g),de=S(()=>s("div",{class:"text"},"\u6682\u65E0\u8BB0\u5F55",-1)),ue={class:"item-left"},ve={class:"left-content"},_e={class:"bottom-text"},pe={class:"item-right"},fe={key:0,class:"bottom-text"},me=["onClick"],ye={key:1,class:"bottom-text"},he=["onClick"],ge=S(()=>s("div",{class:"text"},"\u6682\u65E0\u8BB0\u5F55",-1)),ke={class:"item-left"},xe={class:"left-content"},be=["onClick"],Ce={class:"bottom-text"},we={class:"item-right"},He={class:"status-icon"},Le={class:"content"},Ae={class:"bottom-text"},Re=S(()=>s("span",null,"/",-1)),Se={__name:"History",setup(g){const G=te(),w=se(),f=n(0),k=n(20),m=n([]),H=n(1),L=n(!1),y=n([]),V=n(1),x=n(!1),d=n(!1),b=n(!1),u=n(!1),A=n(!1),J=oe([{name:"\u7EE7\u7EED\u8F6C\u53D1",value:"zh-cn",color:"#3F80F7"},{name:"\u67E5\u770B\u624B\u6C14",value:"zh-cn"}]),K=()=>{console.log(w.walletAddress)};function Q(){T()}function I(){f.value==0?(H.value=1,m.value=[],Y()):f.value==1&&(x.value=!1,y.value=[],U())}function T(){f.value==0?Y():f.value==1&&U()}async function Y(){d.value=!0;let h=z.loading({message:"Loading...",forbidClick:!0,duration:0});try{const t=await B.redPacket.getReceiveHistory(w.walletAddress,k.value,H.value);console.log(t),t.status==1?(console.log(m),m.value=m.value.concat(t.data.list),t.data.list.length<k.value?b.value=!0:H.value++):(console.log("fail"),u.value=!0)}catch(t){console.log(t),u.value=!0}finally{console.log(u.value),h.clear(),L.value=!1,d.value=!1}}async function U(){d.value=!0;let h=z.loading({message:"Loading...",forbidClick:!0,duration:0});try{const t=await B.redPacket.getSendHistory(w.walletAddress,k.value,V.value);console.log(t),t.status==1?(console.log(y),y.value=y.value.concat(t.data.list),t.data.list.length<k.value?b.value=!0:V.value++):(console.log("fail"),u.value=!0)}catch(t){console.log(t),u.value=!1}finally{console.log(u.value),h.clear(),x.value=!1,d.value=!1}}function W(){A.value=!0}function X(h){window.open("https://testnet.bscscan.com/address/"+h,"_blank")}return(h,t)=>{const F=_("van-empty"),N=_("van-cell"),$=_("van-list"),D=_("van-pull-refresh"),M=_("van-tab"),Z=_("van-action-sheet"),ee=_("van-tabs");return o(),c(ee,{class:"history",active:f.value,"onUpdate:active":t[6]||(t[6]=e=>f.value=e),onRendered:Q},{default:a(()=>[l(M,{class:"tab-top",title:"\u6211\u9886\u5230\u7684"},{default:a(()=>[l(D,{modelValue:L.value,"onUpdate:modelValue":t[2]||(t[2]=e=>L.value=e),onRefresh:I},{default:a(()=>[m.value.length==0?(o(),c(F,{key:0,class:"empty-box"},{image:a(()=>[l(i,{class:"icon",name:"emptyHistory"}),de]),_:1})):(o(),c($,{key:1,loading:d.value,"onUpdate:loading":t[0]||(t[0]=e=>d.value=e),finished:b.value,"finished-text":"\u6CA1\u6709\u66F4\u591A\u4E86",error:u.value,"onUpdate:error":t[1]||(t[1]=e=>u.value=e),"error-text":"\u8BF7\u6C42\u5931\u8D25\uFF0C\u70B9\u51FB\u91CD\u65B0\u52A0\u8F7D",onLoad:T},{default:a(()=>[(o(!0),C(j,null,P(m.value,e=>(o(),c(N,{class:"receive-item item",key:e},{title:a(()=>[s("div",ue,[s("div",ve,[s("div",null,[p(r(v(q)(e.userAddress)),1),l(i,{class:"copy-icon",name:"copy",onClick:R=>v(E)(e.userAddress)},null,8,["onClick"])]),s("div",_e,[e.type==0?(o(),c(i,{key:0,class:"type-icon",name:"pin"})):(o(),c(i,{key:1,class:"type-icon",name:"pu"})),p(" "+r(v(O).unix(e.time).format("YYYY-MM-DD HH:mm")),1)])])])]),value:a(()=>[s("div",pe,[s("div",null,r(e.amount)+" "+r(),1),e.tx?(o(),C("div",fe,[s("span",{onClick:R=>X(e.tx)},[p("\u533A\u5757\u6D4F\u89C8\u5668"),l(i,{class:"share-icon",name:"share"})],8,me)])):(o(),C("div",ye,[s("span",{onClick:R=>v(G).push(`/redpacket/${e.uuid}/showLuck`)},"\u67E5\u770B\u624B\u6C14",8,he)]))])]),_:2},1024))),128))]),_:1},8,["loading","finished","error"]))]),_:1},8,["modelValue"])]),_:1}),l(M,{title:"\u6211\u53D1\u51FA\u7684"},{default:a(()=>[l(D,{modelValue:x.value,"onUpdate:modelValue":t[4]||(t[4]=e=>x.value=e),onRefresh:I},{default:a(()=>[y.value.length==0?(o(),c(F,{key:0,class:"empty-box"},{image:a(()=>[l(i,{class:"icon",name:"emptyHistory"}),ge]),_:1})):(o(),c($,{key:1,loading:d.value,"onUpdate:loading":t[3]||(t[3]=e=>d.value=e),finished:b.value,"finished-text":"\u6CA1\u6709\u66F4\u591A\u4E86",onLoad:K},{default:a(()=>[(o(!0),C(j,null,P(y.value,e=>(o(),c(N,{class:"send-item item",key:e,onClick:W},{title:a(()=>[s("div",ke,[l(ie,{tokenIcon:v(ae)(e.contractChain.toLowerCase(),e.contractAddress.toLowerCase())},null,8,["tokenIcon"]),s("div",xe,[s("div",{onClick:ne(R=>v(E)(e.contractAddress),["stop"])},[p(r(v(q)(e.contractAddress)),1),l(i,{class:"copy-icon",name:"copy"})],8,be),s("div",Ce,[e.type==0?(o(),c(i,{key:0,class:"type-icon",name:"pin"})):(o(),c(i,{key:1,class:"type-icon",name:"pu"})),p(" "+r(v(O)(e.createTime).format("YYYY-MM-DD HH:mm")),1)])])])]),value:a(()=>[s("div",we,[s("div",He,[l(i,{class:"type-icon",name:"endCn"})]),s("div",Le,[s("div",null,r(e.totalAmount+" "+e.symbol),1),s("div",Ae,[p(" \u5DF2\u9886 "+r(e.receivedCount),1),Re,p(r(e.count),1)])])])]),_:2},1024))),128))]),_:1},8,["loading","finished"]))]),_:1},8,["modelValue"])]),_:1}),l(Z,{show:A.value,"onUpdate:show":t[5]||(t[5]=e=>A.value=e),actions:J,"cancel-text":"\u53D6\u6D88",description:"0x23\u202667yu\u53D1\u51FA\u7684\u7EA2\u5305","close-on-click-action":""},null,8,["show","actions"])]),_:1},8,["active"])}}},Ue=re(Se,[["__scopeId","data-v-0276e8a9"]]);export{Ue as default};
