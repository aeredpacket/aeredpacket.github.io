import{T as H}from"./TokenIcon.fd9fc353.js";import{_ as S}from"./SvgIcon.a3131f0f.js";import{k as F,j as M,l as j,n as r,q as G,N as Z,O as k,p as q,r as g,o as i,b as l,a,u as s,K as w,t as o,d as n,c as L,g as f,e as C,F as K,G as Q,w as J,P as U,T,s as X,H as x,Q as ee,f as te,C as ae,D as se}from"./index.2009d65b.js";import{u as oe}from"./redPacketStore.b8185e6d.js";import{d as B}from"./dayjs.min.5c48b183.js";import{_ as ie}from"./plugin-vueexport-helper.2444895f.js";const de=m=>(ae("data-v-76413a20"),m=m(),se(),m),le={class:"body"},ne={class:"top"},ce=U('<div class="background" data-v-76413a20><div style="--i:1;" data-v-76413a20></div><div style="--i:2;" data-v-76413a20></div><div style="--i:3;" data-v-76413a20></div><div style="--i:4;" data-v-76413a20></div><div style="--i:5;" data-v-76413a20></div><div style="--i:6;" data-v-76413a20></div><div style="--i:7;" data-v-76413a20></div><div style="--i:8;" data-v-76413a20></div><div style="--i:9;" data-v-76413a20></div><div style="--i:10;" data-v-76413a20></div><div style="--i:11;" data-v-76413a20></div><div style="--i:12;" data-v-76413a20></div><div style="--i:13;" data-v-76413a20></div><div style="--i:14;" data-v-76413a20></div><div style="--i:15;" data-v-76413a20></div><div style="--i:16;" data-v-76413a20></div><div style="--i:17;" data-v-76413a20></div><div style="--i:18;" data-v-76413a20></div><div style="--i:19;" data-v-76413a20></div><div style="--i:20;" data-v-76413a20></div><div style="--i:21;" data-v-76413a20></div><div style="--i:22;" data-v-76413a20></div><div style="--i:23;" data-v-76413a20></div><div style="--i:24;" data-v-76413a20></div><div style="--i:25;" data-v-76413a20></div><div style="--i:26;" data-v-76413a20></div><div style="--i:27;" data-v-76413a20></div><div style="--i:28;" data-v-76413a20></div><div style="--i:29;" data-v-76413a20></div><div style="--i:30;" data-v-76413a20></div><div style="--i:31;" data-v-76413a20></div><div style="--i:32;" data-v-76413a20></div><div style="--i:33;" data-v-76413a20></div><div style="--i:34;" data-v-76413a20></div><div style="--i:35;" data-v-76413a20></div><div style="--i:36;" data-v-76413a20></div></div>',1),ve={key:0,class:"info-box"},re={key:0,class:"fold-operate-fixed"},ue=de(()=>a("span",{class:"dot"},"...",-1)),ye={class:"fold-text"},pe={class:"red-packet"},_e={class:"circle-big"},fe={class:"circle-small"},me={key:0,class:"card"},he={class:"from"},ke={class:"amount"},ge={class:"congratulation"},we={class:"text"},Ce={key:0,class:"logo"},be={key:1},$e={class:"text-top"},Pe={class:"from"},Ie={class:"congratulation"},Re={key:0,class:"front-cover"},Ae={class:"packer-btn packer-btn-behind",style:{transform:"translateZ(-4px)"}},He={class:"packer-btn packer-btn-front"},Se={class:"text-middle"},Le={key:0},Te={key:1},xe={class:"text-bottom"},Be={key:0,class:"award-time"},Ve={class:"bottom"},De={class:"logo"},Ne={__name:"ReceiveRedPacket",setup(m){const e=oe(),v=F(),b=M(),{t:V}=j(),$=r(!1),u=r(!0),y=r(null),p=r(null),_=r(!1),d=r(0),h=r("--");G(()=>{e.getRedPacketDetail(),P()}),Z(()=>e.title,async(t,c)=>{P()});async function P(){if(!e.title)return;await k();let t=p.value.scrollHeight,c=p.value.offsetHeight;console.log(p.value.scrollHeight),console.log(p.value.offsetHeight),t>c&&($.value=!0),document.body.style.setProperty("--top-height",y.value.scrollHeight-10+"px"),window.onresize=()=>(console.log("\u9AD8\u5EA6"),(()=>{document.body.style.setProperty("--top-height",y.value.scrollHeight-10+"px")})())}async function D(){u.value=!1,await k(),document.body.style.setProperty("--top-height",y.value.scrollHeight-10+"px")}async function N(){u.value=!0,await k(),document.body.style.setProperty("--top-height",y.value.scrollHeight-10+"px")}async function W(){console.log("openClick");let t;if(v.walletAddress?t=T.loading():t=T.fail(V("connectWalletWarn")),!_.value){_.value=!0;try{await O()}catch(c){console.log(c)}finally{t.clear(),_.value=!1}}}async function O(){if(!v.isConnectWallet){if(await v.connectWallet(),!v.isConnectWallet)return;await e.getRedPacketDetail(e.uuid,v.walletAddress)}if(e.isReceived){const t=e.receiveList.find(c=>c.userAddress==v.walletAddress);h.value=t.amount,d.value=1;return}if(console.log(e.status),e.status==3)try{const t=await X.redPacket.receive(v.walletAddress,e.uuid);console.log(t),t.status==1&&t.data.status==3&&(e.isReceived=!0,h.value=t.data.receiveResult.amount,d.value=1,e.receiveList.push({transferTime:B().unix(),amount:t.data.receiveResult.amount,userAddress:t.data.receiveResult.userAddress}))}catch(t){console.log(t),d.value=2}else e.count==e.receiveList.length?d.value=2:d.value=3}const I=q(()=>e.creatorAddress?e.creatorAddress.substr(-4).toLowerCase():"--");return(t,c)=>{const Y=g("van-image"),z=g("van-icon"),E=g("van-button");return i(),l("div",le,[a("div",ne,[ce,a("div",{class:"content",ref_key:"content",ref:y},[s(e).title?(i(),l("div",ve,[a("div",{class:w(["info",{fold:u.value}]),ref_key:"info",ref:p},[$.value&&u.value?(i(),l("div",re,[ue,a("span",{class:"fold-operate",onClick:D},o(t.$t("expand")),1)])):n("",!0),a("span",ye,o(s(e).title),1),u.value?n("",!0):(i(),l("span",{key:1,class:"fold-operate",onClick:N},o(t.$t("putAway")),1))],2)])):n("",!0),a("div",pe,[a("div",_e,[a("div",fe,[d.value==1?(i(),l("div",me,[a("div",he,[s(e).contractChain?(i(),L(H,{key:0,class:"token-icon",tokenIcon:s(x)(s(e).contractChain.toLowerCase(),s(e).contractAddress.toLowerCase())},null,8,["tokenIcon"])):n("",!0),a("span",null,o(t.$t("redPacketBelong",{user:s(I)})),1)]),a("div",ke,o(h.value+" "+s(e).symbol),1),a("div",ge,o(s(e).remark),1)])):n("",!0)])]),a("div",we,[d.value!=1?(i(),l("div",Ce,[f(S,{class:"icon",name:"logo"})])):n("",!0),d.value!=1?(i(),l("div",be,[a("div",$e,[a("div",Pe,[s(e).contractChain?(i(),L(H,{key:0,class:"token-icon",tokenIcon:s(x)(s(e).contractChain.toLowerCase(),s(e).contractAddress.toLowerCase())},null,8,["tokenIcon"])):n("",!0),C(o()+" ",1),a("span",null,"*"+o(t.$t("redPacketBelong",{user:s(I)})),1)]),a("div",Ie,o(s(e).remark),1)]),d.value==0&&s(e).coverImage?(i(),l("div",Re,[f(Y,{class:"img",fit:"contain",src:s(e).coverImage},null,8,["src"])])):n("",!0),d.value==0&&!_.value?(i(),l("div",{key:1,class:w(["open",s(v).language=="en"?"open-en":""]),onClick:W},o(t.$t("open")),3)):d.value==0&&_.value?(i(),l("div",{key:2,class:w(["anim-rotate packer-btn-pos",s(v).language=="en"?"open-en":""])},[a("div",Ae,o(t.$t("open")),1),(i(),l(K,null,Q(7,(R,A)=>a("div",{class:"packer-btn-middle",key:A,style:ee({transform:`translateZ(${A-3}px)`})},null,4)),64)),a("div",He,o(t.$t("open")),1)],2)):n("",!0),a("div",Se,[d.value==2?(i(),l("div",Le,[a("div",null,o(t.$t("handSlow")),1),a("div",null,o(t.$t("redPackIsGone")),1)])):n("",!0),d.value==3?(i(),l("div",Te,[a("div",null,o(t.$t("handSlow")),1),a("div",null,o(t.$t("redPackIsExpired")),1)])):n("",!0)])])):n("",!0),a("div",xe,[d.value==1?(i(),l("div",Be,o(t.$t("distributeTime",{date:s(B).unix(s(e).sendTime+s(e).endTime).format("YYYY-MM-DD HH:mm"),address:s(te)(s(v).walletAddress)})),1)):n("",!0),a("div",{class:"show-luck",onClick:c[0]||(c[0]=R=>s(b).push(`/redpacket/${s(e).uuid}/showLuck`))},[C(o(t.$t("seeLuckEveryone"))+" ",1),f(z,{name:"arrow"})])])])])],512)]),a("div",Ve,[f(E,{class:"send-red-packet",onClick:c[1]||(c[1]=R=>s(b).push("/"))},{default:J(()=>[C(o(t.$t("giveOutRedPacket")),1)]),_:1}),a("div",De,[f(S,{class:"icon",name:"logo"})])])])}}},Me=ie(Ne,[["__scopeId","data-v-76413a20"]]);export{Me as default};
