import{T as S,d as L}from"./dayjs.min.94628c86.js";import{_ as T}from"./TokenIcon.vuevuetypestyleindex0scoped7bbb7138lang.d5180bd6.js";import{k as z,j as F,l as j,n as r,I as Z,M as G,p as Q,r as w,o as i,b as l,a as s,u as a,N as C,t as o,d as c,c as x,g as f,e as b,F as q,y as J,w as K,O as U,P as $,T as B,s as X,E as V,Q as ee,f as te,A as se,C as ae}from"./index.14af51bd.js";import{u as oe}from"./redPacketStore.2bbc27da.js";import{_ as ie}from"./plugin-vueexport-helper.2444895f.js";const de=h=>(se("data-v-7519993c"),h=h(),ae(),h),le={class:"body"},ce={class:"top"},ne=U('<div class="background" data-v-7519993c><div style="--i:1;" data-v-7519993c></div><div style="--i:2;" data-v-7519993c></div><div style="--i:3;" data-v-7519993c></div><div style="--i:4;" data-v-7519993c></div><div style="--i:5;" data-v-7519993c></div><div style="--i:6;" data-v-7519993c></div><div style="--i:7;" data-v-7519993c></div><div style="--i:8;" data-v-7519993c></div><div style="--i:9;" data-v-7519993c></div><div style="--i:10;" data-v-7519993c></div><div style="--i:11;" data-v-7519993c></div><div style="--i:12;" data-v-7519993c></div><div style="--i:13;" data-v-7519993c></div><div style="--i:14;" data-v-7519993c></div><div style="--i:15;" data-v-7519993c></div><div style="--i:16;" data-v-7519993c></div><div style="--i:17;" data-v-7519993c></div><div style="--i:18;" data-v-7519993c></div><div style="--i:19;" data-v-7519993c></div><div style="--i:20;" data-v-7519993c></div><div style="--i:21;" data-v-7519993c></div><div style="--i:22;" data-v-7519993c></div><div style="--i:23;" data-v-7519993c></div><div style="--i:24;" data-v-7519993c></div><div style="--i:25;" data-v-7519993c></div><div style="--i:26;" data-v-7519993c></div><div style="--i:27;" data-v-7519993c></div><div style="--i:28;" data-v-7519993c></div><div style="--i:29;" data-v-7519993c></div><div style="--i:30;" data-v-7519993c></div><div style="--i:31;" data-v-7519993c></div><div style="--i:32;" data-v-7519993c></div><div style="--i:33;" data-v-7519993c></div><div style="--i:34;" data-v-7519993c></div><div style="--i:35;" data-v-7519993c></div><div style="--i:36;" data-v-7519993c></div></div>',1),ve={key:0,class:"info-box"},re={key:0,class:"fold-operate-fixed"},ue=de(()=>s("span",{class:"dot"},"...",-1)),ye={class:"fold-text"},pe={class:"red-packet"},_e={class:"circle-big"},fe={class:"circle-small"},he={key:0,class:"card"},ke={class:"from"},me={class:"amount"},ge={class:"congratulation"},we={class:"text"},Ce={key:0,class:"logo"},be={key:1},$e={class:"text-top"},Ie={class:"from"},Pe={class:"congratulation"},Re={key:0,class:"front-cover"},Ae={class:"packer-btn packer-btn-behind",style:{transform:"translateZ(-4px)"}},He={class:"packer-btn packer-btn-front"},Se={class:"text-middle"},Le={key:0},Te={key:1},xe={class:"text-bottom"},Be={key:0,class:"award-time"},Ve={class:"bottom"},Ne={class:"logo"},De={__name:"ReceiveRedPacket",setup(h){const e=oe(),n=z(),I=F(),{t:N}=j(),P=r(!1),u=r(!0),y=r(null),p=r(null),_=r(!1),d=r(0),k=r("--");Z(()=>{e.getRedPacketDetail()});const D=G(()=>e.title,async(t,v)=>{await $();let m=p.value.scrollHeight,g=p.value.offsetHeight;console.log(p.value.scrollHeight),console.log(p.value.offsetHeight),m>g&&(P.value=!0),document.body.style.setProperty("--top-height",y.value.scrollHeight-10+"px"),window.onresize=()=>(console.log("\u9AD8\u5EA6"),(()=>{document.body.style.setProperty("--top-height",y.value.scrollHeight-10+"px")})())});async function W(){u.value=!1,await $(),document.body.style.setProperty("--top-height",y.value.scrollHeight-10+"px")}async function E(){u.value=!0,await $(),document.body.style.setProperty("--top-height",y.value.scrollHeight-10+"px")}async function M(){console.log("openClick");let t;if(n.walletAddress?t=B.loading():t=B.fail(N("connectWalletWarn")),!_.value){_.value=!0;try{await O()}catch(v){console.log(v)}finally{t.clear(),_.value=!1}}}async function O(){if(!n.isConnectWallet){if(await n.connectWallet(),!n.isConnectWallet)return;await e.getRedPacketDetail(e.uuid,n.walletAddress)}if(e.isReceived){const t=e.receiveList.find(v=>v.userAddress==n.walletAddress);k.value=t.amount,d.value=1;return}if(console.log(e.status),e.status==3)try{const t=await X.redPacket.receive(n.walletAddress,e.uuid);console.log(t),t.status==1&&t.data.status==3&&(e.isReceived=!0,k.value=t.data.receiveResult.amount,d.value=1,e.receiveList.push({transferTime:L().unix(),amount:t.data.receiveResult.amount,userAddress:t.data.receiveResult.userAddress}))}catch(t){console.log(t),d.value=2}else e.count==e.receiveList.length?d.value=2:d.value=3}const R=Q(()=>e.creatorAddress?e.creatorAddress.substr(-4).toLowerCase():"--");return(t,v)=>{const m=w("van-image"),g=w("van-icon"),Y=w("van-button");return i(),l("div",le,[s("div",ce,[ne,s("div",{class:"content",ref_key:"content",ref:y},[a(e).title?(i(),l("div",ve,[s("div",{class:C(["info",{fold:u.value}]),ref_key:"info",ref:p},[P.value&&u.value?(i(),l("div",re,[ue,s("span",{class:"fold-operate",onClick:W},o(t.$t("expand")),1)])):c("",!0),s("span",ye,o(a(e).title),1),u.value?c("",!0):(i(),l("span",{key:1,class:"fold-operate",onClick:E},o(t.$t("putAway")),1))],2)])):c("",!0),s("div",pe,[s("div",_e,[s("div",fe,[d.value==1?(i(),l("div",he,[s("div",ke,[a(e).contractChain?(i(),x(S,{key:0,class:"token-icon",tokenIcon:a(V)(a(e).contractChain.toLowerCase(),a(e).contractAddress.toLowerCase())},null,8,["tokenIcon"])):c("",!0),s("span",null,o(t.$t("redPacketBelong",{user:a(R)})),1)]),s("div",me,o(k.value+" "+a(e).symbol),1),s("div",ge,o(a(e).remark),1)])):c("",!0)])]),s("div",we,[d.value!=1?(i(),l("div",Ce,[f(T,{class:"icon",name:"logo"})])):c("",!0),d.value!=1?(i(),l("div",be,[s("div",$e,[s("div",Ie,[a(e).contractChain?(i(),x(S,{key:0,class:"token-icon",tokenIcon:a(V)(a(e).contractChain.toLowerCase(),a(e).contractAddress.toLowerCase())},null,8,["tokenIcon"])):c("",!0),b(o()+" ",1),s("span",null,"*"+o(t.$t("redPacketBelong",{user:a(R)})),1)]),s("div",Pe,o(a(e).remark),1)]),d.value==0&&a(e).coverImage?(i(),l("div",Re,[f(m,{class:"img",fit:"contain",src:a(e).coverImage},null,8,["src"])])):c("",!0),d.value==0&&!_.value?(i(),l("div",{key:1,class:C(["open",a(n).language=="en"?"open-en":""]),onClick:M},o(t.$t("open")),3)):d.value==0&&_.value?(i(),l("div",{key:2,class:C(["anim-rotate packer-btn-pos",a(n).language=="en"?"open-en":""])},[s("div",Ae,o(t.$t("open")),1),(i(),l(q,null,J(7,(A,H)=>s("div",{class:"packer-btn-middle",key:H,style:ee({transform:`translateZ(${H-3}px)`})},null,4)),64)),s("div",He,o(t.$t("open")),1)],2)):c("",!0),s("div",Se,[d.value==2?(i(),l("div",Le,[s("div",null,o(t.$t("handSlow")),1),s("div",null,o(t.$t("redPackIsGone")),1)])):c("",!0),d.value==3?(i(),l("div",Te,[s("div",null,o(t.$t("handSlow")),1),s("div",null,o(t.$t("redPackIsExpired")),1)])):c("",!0)])])):c("",!0),s("div",xe,[d.value==1?(i(),l("div",Be,o(t.$t("distributeTime",{date:a(L).unix(a(e).sendTime).format("YYYY-MM-DD HH:mm"),address:a(te)(a(n).walletAddress)})),1)):c("",!0),s("div",{class:"show-luck",onClick:v[0]||(v[0]=A=>a(I).push(`/redpacket/${a(e).uuid}/showLuck`))},[b(o(t.$t("seeLuckEveryone"))+" ",1),f(g,{name:"arrow"})])])])])],512)]),s("div",Ve,[f(Y,{class:"send-red-packet",onClick:v[1]||(v[1]=A=>a(I).push("/"))},{default:K(()=>[b(o(t.$t("giveOutRedPacket")),1)]),_:1}),s("div",Ne,[f(T,{class:"icon",name:"logo"})])])])}}},ze=ie(De,[["__scopeId","data-v-7519993c"]]);export{ze as default};
