import{T as j}from"./TokenIcon.fcf49d8c.js";import{_ as q,m as E,j as U,k as W,l as z,n as f,q as I,s as D,r as m,o as r,b as p,g as C,a as o,t as d,F as b,I as A,u as n,w as g,N as J,c as $,C as P,f as G,B as w,d as H,T as K,v as L,J as Q}from"./index.935a5b02.js";const X={class:"content"},Y={class:"p-16"},Z={class:"network"},ee={class:"network-list"},te=["onClick"],se={class:"item-left"},oe={class:"left-content"},ne={class:"token-name"},ae={class:"token-address"},le={class:"item-right"},ce={class:"item-right-left"},ie={class:"qty"},re={class:"amount"},de={class:"item-right-right"},ue={__name:"SelectToken",setup(_e){const x=E("global"),y=U(),l=W();z();const B=f([]),v=f([]),c=f(""),S=I(()=>c.value?c.value.startsWith("0x")?v.value.filter(e=>e.address.toLowerCase()==c.value.toLowerCase()):v.value.filter(e=>e.symbol.toLowerCase().indexOf(c.value.toLowerCase())>-1):v.value),h={text:"BSC",value:"bsc",isAllow:!0},u=f({text:h.text,value:h.value,isAllow:h.isAllow}),N=I(()=>{let e=[h];for(let a of B.value){let i=x.cfg.allowChainList.some(k=>k.chain==a.chain),_={text:a.chain.toUpperCase(),value:a.chain,isAllow:i};e.push(_)}return e});async function F(e){!e.isAllow||u.value.value!=e.value&&(u.value=e,T())}async function T(){let e=[];const a=K.loading({message:"Loading...",forbidClick:!0,duration:0});u.value.value=="all"?e=await L.debank.getAllTokenList(l.walletAddress):e=await L.debank.getTokenList(l.walletAddress,u.value.value);let i=e.data.data.filter(t=>new RegExp("^0x.*$","gi").test(t.token)).map(t=>({address:t.token.toLowerCase(),tokenId:`${t.token}-${t.chain}`.toLowerCase(),chain:t.chain.toLowerCase(),symbol:t.symbol,decimals:t.decimals,icon:Q(t.chain.toLowerCase(),t.token.toLowerCase()),amount:t.value,price:t.current_price_usd})),_=i.map(t=>t.tokenId),k=await L.redPacket.tokenlistcheck(_);a.clear(),v.value=i.filter(t=>k.data[t.tokenId].riskScore<60)}function V(e){l.token=e,y.push("/")}function M(){y.push("/")}async function O(){l.isConnectWallet&&await T()}return D(()=>{console.log("onMounted"),O()}),(e,a)=>{const i=m("van-search"),_=m("van-icon"),k=m("van-cell"),t=m("van-list");return r(),p("div",null,[C(i,{modelValue:c.value,"onUpdate:modelValue":a[0]||(a[0]=s=>c.value=s),shape:"round","show-action":"",placeholder:e.$t("searchTokenContractOrName"),"action-text":e.$t("cancel"),onCancel:M},null,8,["modelValue","placeholder","action-text"]),o("div",X,[o("div",Y,d(e.$t("myAssets")),1),o("div",Z,[o("ul",ee,[(r(!0),p(b,null,A(n(N),s=>(r(),p("li",{class:J(u.value.value==s.value?"network-selected":""),onClick:R=>F(s)},d(s.text),11,te))),256))])]),o("div",null,[C(t,{"finished-text":e.$t("noMore"),class:"token-list"},{default:g(()=>[(r(!0),p(b,null,A(n(S),s=>(r(),$(k,{class:"item",key:s,onClick:R=>V(s)},{title:g(()=>[o("div",se,[C(j,{class:"token-icon",tokenIcon:s.icon,chainIcon:n(P)(s.chain)},null,8,["tokenIcon","chainIcon"]),o("div",oe,[o("div",ne,d(s.symbol),1),o("div",ae,d(n(G)(s.address)),1)])])]),value:g(()=>[o("div",le,[o("div",ce,[o("div",ie,d(n(w)(s.amount).toString().indexOf(".")==-1?n(w)(s.amount):n(w)(s.amount).toFixed(6)),1),o("div",re,"$"+d(n(w)(s.amount).multipliedBy(s.price).toFixed(2)),1)]),o("div",de,[n(l).token&&n(l).token.address==s.address?(r(),$(_,{key:0,name:"success",color:"#3F80F7"})):H("",!0)])])]),_:2},1032,["onClick"]))),128))]),_:1},8,["finished-text"])])])])}}},he=q(ue,[["__scopeId","data-v-26f787ca"]]);export{he as default};
