import{T as H}from"./TokenIcon.46a574f9.js";import{_ as S}from"./SvgIcon.a31a0fdf.js";import{_ as M,k as j,j as Z,l as q,n as r,s as G,P as J,R as K,S as k,q as U,r as g,o as d,b as n,a,u as s,O as w,t as o,d as c,c as L,g as _,e as C,F as Q,J as X,w as ee,U as te,V as ae,T,v as se,K as x,W as oe,f as de,H as ie,I as ne}from"./index.309b93bb.js";import{u as le}from"./redPacketStore.0865a475.js";import{d as V}from"./dayjs.min.7ca18867.js";const ce=m=>(ie("data-v-0ad474f7"),m=m(),ne(),m),ve={class:"body"},re={class:"top"},ue=te('<div class="background" data-v-0ad474f7><div style="--i:1;" data-v-0ad474f7></div><div style="--i:2;" data-v-0ad474f7></div><div style="--i:3;" data-v-0ad474f7></div><div style="--i:4;" data-v-0ad474f7></div><div style="--i:5;" data-v-0ad474f7></div><div style="--i:6;" data-v-0ad474f7></div><div style="--i:7;" data-v-0ad474f7></div><div style="--i:8;" data-v-0ad474f7></div><div style="--i:9;" data-v-0ad474f7></div><div style="--i:10;" data-v-0ad474f7></div><div style="--i:11;" data-v-0ad474f7></div><div style="--i:12;" data-v-0ad474f7></div><div style="--i:13;" data-v-0ad474f7></div><div style="--i:14;" data-v-0ad474f7></div><div style="--i:15;" data-v-0ad474f7></div><div style="--i:16;" data-v-0ad474f7></div><div style="--i:17;" data-v-0ad474f7></div><div style="--i:18;" data-v-0ad474f7></div><div style="--i:19;" data-v-0ad474f7></div><div style="--i:20;" data-v-0ad474f7></div><div style="--i:21;" data-v-0ad474f7></div><div style="--i:22;" data-v-0ad474f7></div><div style="--i:23;" data-v-0ad474f7></div><div style="--i:24;" data-v-0ad474f7></div><div style="--i:25;" data-v-0ad474f7></div><div style="--i:26;" data-v-0ad474f7></div><div style="--i:27;" data-v-0ad474f7></div><div style="--i:28;" data-v-0ad474f7></div><div style="--i:29;" data-v-0ad474f7></div><div style="--i:30;" data-v-0ad474f7></div><div style="--i:31;" data-v-0ad474f7></div><div style="--i:32;" data-v-0ad474f7></div><div style="--i:33;" data-v-0ad474f7></div><div style="--i:34;" data-v-0ad474f7></div><div style="--i:35;" data-v-0ad474f7></div><div style="--i:36;" data-v-0ad474f7></div></div>',1),fe={key:0,class:"info-box"},ye={key:0,class:"fold-operate-fixed"},pe=ce(()=>a("span",{class:"dot"},"...",-1)),_e={class:"fold-text"},me={class:"red-packet"},he={class:"circle-big"},ke={class:"circle-small"},ge={key:0,class:"card"},we={class:"from"},Ce={class:"amount"},be={class:"congratulation"},Ie={class:"text"},Pe={key:0,class:"logo"},Re={key:1},$e={class:"text-top"},Ae={class:"from"},He={class:"congratulation"},Se={key:0,class:"front-cover"},Le={class:"packer-btn packer-btn-behind",style:{transform:"translateZ(-4px)"}},Te={class:"packer-btn packer-btn-front"},xe={class:"text-middle"},Ve={key:0},Be={key:1},We={class:"text-bottom"},De={key:0,class:"award-time"},Ne={class:"bottom"},Oe={class:"logo"},Ye={__name:"ReceiveRedPacket",setup(m){const e=le(),v=j(),b=Z(),{t:B}=q(),I=r(!1),u=r(!0),f=r(null),y=r(null),p=r(!1),i=r(0),h=r("--");G(()=>{const l=J().params.uuid;e.uuid=l,e.getRedPacketDetail(),P()}),K(()=>e.title,async(t,l)=>{P()});async function P(){if(!e.title)return;await k();let t=y.value.scrollHeight,l=y.value.offsetHeight;console.log(y.value.scrollHeight),console.log(y.value.offsetHeight),t>l&&(I.value=!0),document.body.style.setProperty("--top-height",f.value.scrollHeight-10+"px"),window.onresize=()=>(console.log("\u9AD8\u5EA6"),(()=>{document.body.style.setProperty("--top-height",f.value.scrollHeight-10+"px")})())}async function W(){u.value=!1,await k(),document.body.style.setProperty("--top-height",f.value.scrollHeight-10+"px")}async function D(){u.value=!0,await k(),document.body.style.setProperty("--top-height",f.value.scrollHeight-10+"px")}async function N(){ae([e.coverImage])}async function O(){console.log("openClick");let t;if(v.walletAddress?t=T.loading():t=T.fail(B("connectWalletWarn")),!p.value){p.value=!0;try{await Y()}catch(l){console.log(l)}finally{t.clear(),p.value=!1}}}async function Y(){if(!v.isConnectWallet){if(await v.connectWallet(),!v.isConnectWallet)return;await e.getRedPacketDetail(e.uuid,v.walletAddress)}if(e.isReceived){const t=e.receiveList.find(l=>l.userAddress==v.walletAddress);h.value=t.amount,i.value=1;return}if(console.log(e.status),e.status==3)try{const t=await se.redPacket.receive(v.walletAddress,e.uuid);console.log(t),t.status==1&&t.data.status==3&&(e.isReceived=!0,h.value=t.data.receiveResult.amount,i.value=1,e.receiveList.push({transferTime:V().unix(),amount:t.data.receiveResult.amount,userAddress:t.data.receiveResult.userAddress}))}catch(t){console.log(t),i.value=2}else e.count==e.receiveList.length?i.value=2:i.value=3}const R=U(()=>e.creatorAddress?e.creatorAddress.substr(-4).toLowerCase():"--");return(t,l)=>{const z=g("van-image"),E=g("van-icon"),F=g("van-button");return d(),n("div",ve,[a("div",re,[ue,a("div",{class:"content",ref_key:"content",ref:f},[s(e).title?(d(),n("div",fe,[a("div",{class:w(["info",{fold:u.value}]),ref_key:"info",ref:y},[I.value&&u.value?(d(),n("div",ye,[pe,a("span",{class:"fold-operate",onClick:W},o(t.$t("expand")),1)])):c("",!0),a("span",_e,o(s(e).title),1),u.value?c("",!0):(d(),n("span",{key:1,class:"fold-operate",onClick:D},o(t.$t("putAway")),1))],2)])):c("",!0),a("div",me,[a("div",he,[a("div",ke,[i.value==1?(d(),n("div",ge,[a("div",we,[s(e).contractChain?(d(),L(H,{key:0,class:"token-icon",tokenIcon:s(x)(s(e).contractChain.toLowerCase(),s(e).contractAddress.toLowerCase())},null,8,["tokenIcon"])):c("",!0),a("span",null,o(t.$t("redPacketBelong",{user:s(R)})),1)]),a("div",Ce,o(h.value+" "+s(e).symbol),1),a("div",be,o(s(e).remark),1)])):c("",!0)])]),a("div",Ie,[i.value!=1?(d(),n("div",Pe,[_(S,{class:"icon",name:"logo"})])):c("",!0),i.value!=1?(d(),n("div",Re,[a("div",$e,[a("div",Ae,[s(e).contractChain?(d(),L(H,{key:0,class:"token-icon",tokenIcon:s(x)(s(e).contractChain.toLowerCase(),s(e).contractAddress.toLowerCase())},null,8,["tokenIcon"])):c("",!0),C(o()+" ",1),a("span",null,"*"+o(t.$t("redPacketBelong",{user:s(R)})),1)]),a("div",He,o(s(e).remark),1)]),i.value==0&&s(e).coverImage?(d(),n("div",Se,[_(z,{class:"img",fit:"contain",src:s(e).coverImage,onClick:N},null,8,["src"])])):c("",!0),i.value==0&&!p.value?(d(),n("div",{key:1,class:w(["open",s(v).language=="en"?"open-en":""]),onClick:O},o(t.$t("open")),3)):i.value==0&&p.value?(d(),n("div",{key:2,class:w(["anim-rotate packer-btn-pos",s(v).language=="en"?"open-en":""])},[a("div",Le,o(t.$t("open")),1),(d(),n(Q,null,X(7,($,A)=>a("div",{class:"packer-btn-middle",key:A,style:oe({transform:`translateZ(${A-3}px)`})},null,4)),64)),a("div",Te,o(t.$t("open")),1)],2)):c("",!0),a("div",xe,[i.value==2?(d(),n("div",Ve,[a("div",null,o(t.$t("handSlow")),1),a("div",null,o(t.$t("redPackIsGone")),1)])):c("",!0),i.value==3?(d(),n("div",Be,[a("div",null,o(t.$t("handSlow")),1),a("div",null,o(t.$t("redPackIsExpired")),1)])):c("",!0)])])):c("",!0),a("div",We,[i.value==1?(d(),n("div",De,o(t.$t("distributeTime",{date:s(V).unix(s(e).sendTime+s(e).endTime).format("YYYY-MM-DD HH:mm"),address:s(de)(s(v).walletAddress)})),1)):c("",!0),a("div",{class:"show-luck",onClick:l[0]||(l[0]=$=>s(b).push(`/redpacket/${s(e).uuid}/showLuck`))},[C(o(t.$t("seeLuckEveryone"))+" ",1),_(E,{name:"arrow"})])])])])],512)]),a("div",Ne,[_(F,{class:"send-red-packet",onClick:l[1]||(l[1]=$=>s(b).push("/"))},{default:ee(()=>[C(o(t.$t("giveOutRedPacket")),1)]),_:1}),a("div",Oe,[_(S,{class:"icon",name:"logo"})])])])}}},Ze=M(Ye,[["__scopeId","data-v-0ad474f7"]]);export{Ze as default};
