import{T as x}from"./TokenIcon.f61e6cfd.js";import{_ as E,m as R,j as U,k as W,l as z,n as k,q as y,s as D,r as h,o as i,b as f,g as w,a as o,t as r,F as b,J as T,u as n,w as C,O as J,c as A,C as K,f as G,B as m,d as H,T as P,v as I,K as Q}from"./index.c2da4396.js";const X={class:"content"},Y={class:"p-16"},Z={class:"network"},ee={class:"network-list"},te=["onClick"],se={class:"item-left"},oe={class:"left-content"},ne={class:"token-name"},ae={class:"token-address"},le={class:"item-right"},ce={class:"item-right-left"},ie={class:"qty"},re={class:"amount"},ue={class:"item-right-right"},de={__name:"SelectToken",setup(_e){const $=R("global"),g=U(),l=W();z();const B=k([]),_=k([]),c=k(""),S=y(()=>c.value?c.value.startsWith("0x")?_.value.filter(t=>t.address.toLowerCase()==c.value.toLowerCase()):_.value.filter(t=>t.symbol.toLowerCase().indexOf(c.value.toLowerCase())>-1):_.value),v={text:"BSC",value:"bsc",isAllow:!0},u=k({text:v.text,value:v.value,isAllow:v.isAllow}),F=y(()=>{let t=[v];for(let a of B.value){let d=$.cfg.allowChainList.some(p=>p.chain==a.chain),e={text:a.chain.toUpperCase(),value:a.chain,isAllow:d};t.push(e)}return t});async function N(t){!t.isAllow||u.value.value!=t.value&&(u.value=t,L())}async function L(){let t=[];const a=P.loading({message:"Loading...",forbidClick:!0,duration:0});u.value.value=="all"?t=await I.debank.getAllTokenList(l.walletAddress):t=await I.debank.getTokenList(l.walletAddress,u.value.value);let d=t.data.data.filter(e=>new RegExp("^0x.*$","gi").test(e.token)&&e.value>0&&e.risk_score<60&&e.risk_level>=0&&e.flag!=="blacklist"&&e.symbol!==""&&e.flag!=="lp"&&e.token!="0xeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee").map(e=>({address:e.token.toLowerCase(),tokenId:`${e.token}-${e.chain}`.toLowerCase(),chain:e.chain.toLowerCase(),symbol:e.symbol,decimals:e.decimals,icon:Q(e.chain.toLowerCase(),e.token.toLowerCase()),amount:e.value,price:e.current_price_usd}));_.value=d,a.clear()}function V(t){l.token=t,g.push("/")}function O(){g.push("/")}async function M(){l.isConnectWallet&&await L()}return D(()=>{console.log("onMounted"),M()}),(t,a)=>{const d=h("van-search"),e=h("van-icon"),p=h("van-cell"),j=h("van-list");return i(),f("div",null,[w(d,{modelValue:c.value,"onUpdate:modelValue":a[0]||(a[0]=s=>c.value=s),shape:"round","show-action":"",placeholder:t.$t("searchTokenContractOrName"),"action-text":t.$t("cancel"),onCancel:O},null,8,["modelValue","placeholder","action-text"]),o("div",X,[o("div",Y,r(t.$t("myAssets")),1),o("div",Z,[o("ul",ee,[(i(!0),f(b,null,T(n(F),s=>(i(),f("li",{class:J(u.value.value==s.value?"network-selected":""),onClick:q=>N(s)},r(s.text),11,te))),256))])]),o("div",null,[w(j,{"finished-text":t.$t("noMore"),class:"token-list"},{default:C(()=>[(i(!0),f(b,null,T(n(S),s=>(i(),A(p,{class:"item",key:s,onClick:q=>V(s)},{title:C(()=>[o("div",se,[w(x,{class:"token-icon",tokenIcon:s.icon,chainIcon:n(K)(s.chain)},null,8,["tokenIcon","chainIcon"]),o("div",oe,[o("div",ne,r(s.symbol),1),o("div",ae,r(n(G)(s.address)),1)])])]),value:C(()=>[o("div",le,[o("div",ce,[o("div",ie,r(n(m)(s.amount).toString().indexOf(".")==-1?n(m)(s.amount):n(m)(s.amount).toFixed(6)),1),o("div",re,"$"+r(n(m)(s.amount).multipliedBy(s.price).toFixed(2)),1)]),o("div",ue,[n(l).token&&n(l).token.address==s.address?(i(),A(e,{key:0,name:"success",color:"#3F80F7"})):H("",!0)])])]),_:2},1032,["onClick"]))),128))]),_:1},8,["finished-text"])])])])}}},he=E(de,[["__scopeId","data-v-fea20339"]]);export{he as default};
