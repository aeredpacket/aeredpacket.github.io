import{j as ae,k as le,n as d,q as j,r as p,o as s,c as a,w as c,T as q,s as z,g as u,a as n,t as l,b as m,y as G,u as r,D as O,E as J,e as _,f as R,h as K,F as I,G as ce,A as re,C as ie}from"./index.14af51bd.js";import{T as Q,d as W}from"./dayjs.min.94628c86.js";import{_ as i}from"./TokenIcon.vuevuetypestyleindex0scoped7bbb7138lang.d5180bd6.js";import{_ as de}from"./plugin-vueexport-helper.2444895f.js";const ue=C=>(re("data-v-9dc789cf"),C=C(),ie(),C),ve={class:"text"},fe={class:"item-left"},pe={class:"left-content"},_e={class:"bottom-text"},ye={class:"item-right"},he={key:0,class:"bottom-text"},ke=["onClick"],ge={key:1,class:"bottom-text"},me=["onClick"],Ce={class:"text"},we={class:"item-left"},be={class:"left-content"},xe=["onClick"],Le={class:"bottom-text"},$e={class:"item-right"},Ie={class:"status-icon"},Ae={class:"content"},He={class:"bottom-text"},Te=ue(()=>n("span",null,"/",-1)),Ue={__name:"History",setup(C){const A=ae(),w=le(),y=d(0),b=d(20),h=d([]),H=d(1),T=d(!1),k=d([]),V=d(1),x=d(!1),f=d(!1),L=d(!1),v=d(!1),U=d(!1),X=j([{name:"\u7EE7\u7EED\u8F6C\u53D1",value:"0",color:"#3F80F7"},{name:"\u67E5\u770B\u624B\u6C14",value:"1"}]),g=j({creatorAddress:"",showLuckUrl:"",redPacketUrl:""});function Z(o){o.refundTx==""&&o.unlockTx==""&&(U.value=!0,g.creatorAddress=R(o.creatorAddress)+"\u53D1\u51FA\u7684\u7EA2\u5305",g.showLuckUrl="/redpacket/"+o.uuid+"/showLuck",g.redPacketUrl="/redpacket/"+o.uuid)}function ee(o){o.value==0?A.push(g.redPacketUrl):o.value==1&&A.push(g.showLuckUrl)}function te(o){window.open("https://testnet.bscscan.com/tx/"+o,"_blank")}function oe(){S()}function Y(){y.value==0?(H.value=1,h.value=[],M()):y.value==1&&(x.value=!1,k.value=[],P())}function S(){y.value==0?M():y.value==1&&P()}async function M(){f.value=!0;let o=q.loading({message:"Loading...",forbidClick:!0,duration:0});try{const t=await z.redPacket.getReceiveHistory(w.walletAddress,b.value,H.value);console.log(t),t.status==1?(console.log(h),h.value=h.value.concat(t.data.list),t.data.list.length<b.value?L.value=!0:H.value++):(console.log("fail"),v.value=!0)}catch(t){console.log(t),v.value=!0}finally{console.log(v.value),o.clear(),T.value=!1,f.value=!1}}async function P(){f.value=!0;let o=q.loading({message:"Loading...",forbidClick:!0,duration:0});try{const t=await z.redPacket.getSendHistory(w.walletAddress,b.value,V.value);console.log(t),t.status==1?(console.log(k),k.value=k.value.concat(t.data.list),t.data.list.length<b.value?L.value=!0:V.value++):(console.log("fail"),v.value=!0)}catch(t){console.log(t),v.value=!1}finally{console.log(v.value),o.clear(),x.value=!1,f.value=!1}}return(o,t)=>{const D=p("van-empty"),F=p("van-cell"),N=p("van-list"),B=p("van-pull-refresh"),E=p("van-tab"),se=p("van-action-sheet"),ne=p("van-tabs");return s(),a(ne,{class:"history",active:y.value,"onUpdate:active":t[7]||(t[7]=e=>y.value=e),onRendered:oe},{default:c(()=>[u(E,{class:"tab-top",title:o.$t("ireceived")},{default:c(()=>[u(B,{modelValue:T.value,"onUpdate:modelValue":t[2]||(t[2]=e=>T.value=e),onRefresh:Y},{default:c(()=>[h.value.length==0?(s(),a(D,{key:0,class:"empty-box"},{image:c(()=>[u(i,{class:"icon",name:"emptyHistory"}),n("div",ve,l(o.$t("noRecord")),1)]),_:1})):(s(),a(N,{key:1,loading:f.value,"onUpdate:loading":t[0]||(t[0]=e=>f.value=e),finished:L.value,"finished-text":o.$t("noMore"),error:v.value,"onUpdate:error":t[1]||(t[1]=e=>v.value=e),"error-text":o.$t("errorText"),onLoad:S},{default:c(()=>[(s(!0),m(I,null,G(h.value,e=>(s(),a(F,{class:"receive-item item",key:e},{title:c(()=>[n("div",fe,[u(Q,{chainIcon:r(O)(e.contractChain),tokenIcon:r(J)(e.contractChain.toLowerCase(),e.contractAddress.toLowerCase())},null,8,["chainIcon","tokenIcon"]),n("div",pe,[n("div",null,[_(l(r(R)(e.userAddress)),1),u(i,{class:"copy-icon",name:"copy",onClick:$=>r(K)(e.userAddress)},null,8,["onClick"])]),n("div",_e,[e.type==0?(s(),a(i,{key:0,class:"type-icon",name:"pin"})):(s(),a(i,{key:1,class:"type-icon",name:"pu"})),_(" "+l(r(W).unix(e.time).format("YYYY-MM-DD HH:mm")),1)])])])]),value:c(()=>[n("div",ye,[n("div",null,l(e.amount)+" "+l(e.symbol),1),e.tx?(s(),m("div",he,[n("span",{onClick:$=>te(e.tx)},[_(l(o.$t("Blockchain browser")),1),u(i,{class:"share-icon",name:"share"})],8,ke)])):(s(),m("div",ge,[n("span",{onClick:$=>r(A).push(`/redpacket/${e.uuid}/showLuck`)},l(o.$t("seeLuck")),9,me)]))])]),_:2},1024))),128))]),_:1},8,["loading","finished","finished-text","error","error-text"]))]),_:1},8,["modelValue"])]),_:1},8,["title"]),u(E,{title:o.$t("isend")},{default:c(()=>[u(B,{modelValue:x.value,"onUpdate:modelValue":t[5]||(t[5]=e=>x.value=e),onRefresh:Y},{default:c(()=>[k.value.length==0?(s(),a(D,{key:0,class:"empty-box"},{image:c(()=>[u(i,{class:"icon",name:"emptyHistory"}),n("div",Ce,l(o.$t("noRecord")),1)]),_:1})):(s(),a(N,{key:1,loading:f.value,"onUpdate:loading":t[3]||(t[3]=e=>f.value=e),finished:L.value,"finished-text":o.$t("noMore"),error:v.value,"onUpdate:error":t[4]||(t[4]=e=>v.value=e),"error-text":o.$t("errorText"),onLoad:S},{default:c(()=>[(s(!0),m(I,null,G(k.value,e=>(s(),a(F,{class:"send-item item",key:e,onClick:$=>Z(e)},{title:c(()=>[n("div",we,[u(Q,{chainIcon:r(O)(e.contractChain),tokenIcon:r(J)(e.contractChain.toLowerCase(),e.contractAddress.toLowerCase())},null,8,["chainIcon","tokenIcon"]),n("div",be,[n("div",{onClick:ce($=>r(K)(e.creatorAddress),["stop"])},[_(l(r(R)(e.creatorAddress)),1),u(i,{class:"copy-icon",name:"copy"})],8,xe),n("div",Le,[e.type==0?(s(),a(i,{key:0,class:"type-icon",name:"pin"})):(s(),a(i,{key:1,class:"type-icon",name:"pu"})),_(" "+l(r(W)(e.createTime).format("YYYY-MM-DD HH:mm")),1)])])])]),value:c(()=>[n("div",$e,[n("div",Ie,[e.refundTx!=""||e.unlockTx!=""?(s(),m(I,{key:0},[r(w).language=="en"?(s(),a(i,{key:0,class:"type-icon",name:"endEn"})):(s(),a(i,{key:1,class:"type-icon",name:"endCn"}))],64)):(s(),m(I,{key:1},[r(w).language=="en"?(s(),a(i,{key:0,class:"type-icon",name:"goingEn"})):(s(),a(i,{key:1,class:"type-icon",name:"goingCn"}))],64))]),n("div",Ae,[n("div",null,l(e.totalAmount+" "+e.symbol),1),n("div",He,[_(l(o.$t("received"))+" "+l(e.receivedCount),1),Te,_(l(e.count),1)])])])]),_:2},1032,["onClick"]))),128))]),_:1},8,["loading","finished","finished-text","error","error-text"]))]),_:1},8,["modelValue"])]),_:1},8,["title"]),u(se,{show:U.value,"onUpdate:show":t[6]||(t[6]=e=>U.value=e),actions:X,"cancel-text":"\u53D6\u6D88",description:g.creatorAddress,"close-on-click-action":"",onSelect:ee},null,8,["show","actions","description"])]),_:1},8,["active"])}}},Me=de(Ue,[["__scopeId","data-v-9dc789cf"]]);export{Me as default};
