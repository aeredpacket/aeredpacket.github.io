import{T as S}from"./TokenIcon.6be963cc.js";import{_ as H}from"./SvgIcon.fd03929e.js";import{_ as M,k as j,j as Z,l as q,n as r,s as G,R as J,S as k,q as K,r as g,o,b as l,a as d,u as s,O as w,t as a,d as n,c as L,g as p,e as C,F as U,K as Q,w as X,U as ee,V as te,T,v as de,L as x,W as se,f as ae,I as oe,J as ie}from"./index.b2530e2f.js";import{u as le}from"./redPacketStore.b6d1d5d6.js";import{d as V}from"./dayjs.min.78386d6a.js";const ne=m=>(oe("data-v-d1ddf929"),m=m(),ie(),m),ce={class:"body"},ve={class:"top"},re=ee('<div class="background" data-v-d1ddf929><div style="--i:1;" data-v-d1ddf929></div><div style="--i:2;" data-v-d1ddf929></div><div style="--i:3;" data-v-d1ddf929></div><div style="--i:4;" data-v-d1ddf929></div><div style="--i:5;" data-v-d1ddf929></div><div style="--i:6;" data-v-d1ddf929></div><div style="--i:7;" data-v-d1ddf929></div><div style="--i:8;" data-v-d1ddf929></div><div style="--i:9;" data-v-d1ddf929></div><div style="--i:10;" data-v-d1ddf929></div><div style="--i:11;" data-v-d1ddf929></div><div style="--i:12;" data-v-d1ddf929></div><div style="--i:13;" data-v-d1ddf929></div><div style="--i:14;" data-v-d1ddf929></div><div style="--i:15;" data-v-d1ddf929></div><div style="--i:16;" data-v-d1ddf929></div><div style="--i:17;" data-v-d1ddf929></div><div style="--i:18;" data-v-d1ddf929></div><div style="--i:19;" data-v-d1ddf929></div><div style="--i:20;" data-v-d1ddf929></div><div style="--i:21;" data-v-d1ddf929></div><div style="--i:22;" data-v-d1ddf929></div><div style="--i:23;" data-v-d1ddf929></div><div style="--i:24;" data-v-d1ddf929></div><div style="--i:25;" data-v-d1ddf929></div><div style="--i:26;" data-v-d1ddf929></div><div style="--i:27;" data-v-d1ddf929></div><div style="--i:28;" data-v-d1ddf929></div><div style="--i:29;" data-v-d1ddf929></div><div style="--i:30;" data-v-d1ddf929></div><div style="--i:31;" data-v-d1ddf929></div><div style="--i:32;" data-v-d1ddf929></div><div style="--i:33;" data-v-d1ddf929></div><div style="--i:34;" data-v-d1ddf929></div><div style="--i:35;" data-v-d1ddf929></div><div style="--i:36;" data-v-d1ddf929></div></div>',1),ue={key:0,class:"info-box"},fe={key:0,class:"fold-operate-fixed"},ye=ne(()=>d("span",{class:"dot"},"...",-1)),_e={class:"fold-text"},pe={class:"red-packet"},me={class:"circle-big"},he={class:"circle-small"},ke={key:0,class:"card"},ge={class:"from"},we={class:"amount"},Ce={class:"congratulation"},be={class:"text"},Ie={key:0,class:"logo"},$e={key:1},Pe={class:"text-top"},Re={class:"from"},Ae={class:"congratulation"},Se={key:0,class:"front-cover"},He={class:"packer-btn packer-btn-behind",style:{transform:"translateZ(-4px)"}},Le={class:"packer-btn packer-btn-front"},Te={class:"text-middle"},xe={key:0},Ve={key:1},Be={class:"text-bottom"},We={key:0,class:"award-time"},De={class:"bottom"},Ne={class:"logo"},Oe={__name:"ReceiveRedPacket",setup(m){const e=le(),v=j(),b=Z(),{t:B}=q(),I=r(!1),u=r(!0),f=r(null),y=r(null),_=r(!1),i=r(0),h=r("--");G(()=>{e.getRedPacketDetail(),$()}),J(()=>e.title,async(t,c)=>{$()});async function $(){if(!e.title)return;await k();let t=y.value.scrollHeight,c=y.value.offsetHeight;console.log(y.value.scrollHeight),console.log(y.value.offsetHeight),t>c&&(I.value=!0),document.body.style.setProperty("--top-height",f.value.scrollHeight-10+"px"),window.onresize=()=>(console.log("\u9AD8\u5EA6"),(()=>{document.body.style.setProperty("--top-height",f.value.scrollHeight-10+"px")})())}async function W(){u.value=!1,await k(),document.body.style.setProperty("--top-height",f.value.scrollHeight-10+"px")}async function D(){u.value=!0,await k(),document.body.style.setProperty("--top-height",f.value.scrollHeight-10+"px")}async function N(){te([e.coverImage])}async function O(){console.log("openClick");let t;if(v.walletAddress?t=T.loading():t=T.fail(B("connectWalletWarn")),!_.value){_.value=!0;try{await Y()}catch(c){console.log(c)}finally{t.clear(),_.value=!1}}}async function Y(){if(!v.isConnectWallet){if(await v.connectWallet(),!v.isConnectWallet)return;await e.getRedPacketDetail(e.uuid,v.walletAddress)}if(e.isReceived){const t=e.receiveList.find(c=>c.userAddress==v.walletAddress);h.value=t.amount,i.value=1;return}if(console.log(e.status),e.status==3)try{const t=await de.redPacket.receive(v.walletAddress,e.uuid);console.log(t),t.status==1&&t.data.status==3&&(e.isReceived=!0,h.value=t.data.receiveResult.amount,i.value=1,e.receiveList.push({transferTime:V().unix(),amount:t.data.receiveResult.amount,userAddress:t.data.receiveResult.userAddress}))}catch(t){console.log(t),i.value=2}else e.count==e.receiveList.length?i.value=2:i.value=3}const P=K(()=>e.creatorAddress?e.creatorAddress.substr(-4).toLowerCase():"--");return(t,c)=>{const z=g("van-image"),E=g("van-icon"),F=g("van-button");return o(),l("div",ce,[d("div",ve,[re,d("div",{class:"content",ref_key:"content",ref:f},[s(e).title?(o(),l("div",ue,[d("div",{class:w(["info",{fold:u.value}]),ref_key:"info",ref:y},[I.value&&u.value?(o(),l("div",fe,[ye,d("span",{class:"fold-operate",onClick:W},a(t.$t("expand")),1)])):n("",!0),d("span",_e,a(s(e).title),1),u.value?n("",!0):(o(),l("span",{key:1,class:"fold-operate",onClick:D},a(t.$t("putAway")),1))],2)])):n("",!0),d("div",pe,[d("div",me,[d("div",he,[i.value==1?(o(),l("div",ke,[d("div",ge,[s(e).contractChain?(o(),L(S,{key:0,class:"token-icon",tokenIcon:s(x)(s(e).contractChain.toLowerCase(),s(e).contractAddress.toLowerCase())},null,8,["tokenIcon"])):n("",!0),d("span",null,a(t.$t("redPacketBelong",{user:s(P)})),1)]),d("div",we,a(h.value+" "+s(e).symbol),1),d("div",Ce,a(s(e).remark),1)])):n("",!0)])]),d("div",be,[i.value!=1?(o(),l("div",Ie,[p(H,{class:"icon",name:"logo"})])):n("",!0),i.value!=1?(o(),l("div",$e,[d("div",Pe,[d("div",Re,[s(e).contractChain?(o(),L(S,{key:0,class:"token-icon",tokenIcon:s(x)(s(e).contractChain.toLowerCase(),s(e).contractAddress.toLowerCase())},null,8,["tokenIcon"])):n("",!0),C(a()+" ",1),d("span",null,"*"+a(t.$t("redPacketBelong",{user:s(P)})),1)]),d("div",Ae,a(s(e).remark),1)]),i.value==0&&s(e).coverImage?(o(),l("div",Se,[p(z,{class:"img",fit:"contain",src:s(e).coverImage,onClick:N},null,8,["src"])])):n("",!0),i.value==0&&!_.value?(o(),l("div",{key:1,class:w(["open",s(v).language=="en"?"open-en":""]),onClick:O},a(t.$t("open")),3)):i.value==0&&_.value?(o(),l("div",{key:2,class:w(["anim-rotate packer-btn-pos",s(v).language=="en"?"open-en":""])},[d("div",He,a(t.$t("open")),1),(o(),l(U,null,Q(7,(R,A)=>d("div",{class:"packer-btn-middle",key:A,style:se({transform:`translateZ(${A-3}px)`})},null,4)),64)),d("div",Le,a(t.$t("open")),1)],2)):n("",!0),d("div",Te,[i.value==2?(o(),l("div",xe,[d("div",null,a(t.$t("handSlow")),1),d("div",null,a(t.$t("redPackIsGone")),1)])):n("",!0),i.value==3?(o(),l("div",Ve,[d("div",null,a(t.$t("handSlow")),1),d("div",null,a(t.$t("redPackIsExpired")),1)])):n("",!0)])])):n("",!0),d("div",Be,[i.value==1?(o(),l("div",We,a(t.$t("distributeTime",{date:s(V).unix(s(e).sendTime+s(e).endTime).format("YYYY-MM-DD HH:mm"),address:s(ae)(s(v).walletAddress)})),1)):n("",!0),d("div",{class:"show-luck",onClick:c[0]||(c[0]=R=>s(b).push(`/redpacket/${s(e).uuid}/showLuck`))},[C(a(t.$t("seeLuckEveryone"))+" ",1),p(E,{name:"arrow"})])])])])],512)]),d("div",De,[p(F,{class:"send-red-packet",onClick:c[1]||(c[1]=R=>s(b).push("/"))},{default:X(()=>[C(a(t.$t("giveOutRedPacket")),1)]),_:1}),d("div",Ne,[p(H,{class:"icon",name:"logo"})])])])}}},je=M(Oe,[["__scopeId","data-v-d1ddf929"]]);export{je as default};
