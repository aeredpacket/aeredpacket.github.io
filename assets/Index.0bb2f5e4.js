import{r as m,o as i,c as y,w as o,a as l,b as p,d as ee,F as J,e as _,t as b,u as k,f as ce,g as t,h as ue,i as $e,p as de,j as re,k as Se,l as Ie,m as Be,n as Ne,q as u,s as ie,v as ae,x as N,y as j,T as q,B as te,z as Pe,A as Le}from"./index.39920047.js";import{_ as V}from"./TokenIcon.vuevuetypestyleindex0scoped7bbb7138lang.c2af20bb.js";import{_ as ve}from"./plugin-vueexport-helper.2444895f.js";const Te=n=>(de("data-v-4d8c2315"),n=n(),re(),n),He=Te(()=>l("div",{class:"title"},"\u4EA4\u6613\u8BE6\u60C5",-1)),Ue={class:"body"},Fe={class:"status-text"},ze={key:0},Ee={key:1},De={key:2},Re={key:3},We={class:"status-icon"},Oe={class:"tx"},je={key:1,class:"trade-hash"},qe={__name:"ChainTrade",props:{tradeVisable:{type:Boolean,default:!1},status:{type:Number,default:0},tradeHash:{type:String,default:""}},emits:["update:tradeVisable"],setup(n,{emit:le}){return(r,$)=>{const K=m("van-loading"),P=m("van-icon"),z=m("van-popup");return i(),y(z,{class:"dialog",show:n.tradeVisable,"onUpdate:show":$[1]||($[1]=x=>$e(tradeVisable)?tradeVisable.value=x:null),round:"","close-on-click-overlay":!1},{default:o(()=>[He,l("div",Ue,[l("div",Fe,[n.status!=0?(i(),p(J,{key:0},[n.status==1?(i(),p("div",ze,"\u53D1\u9001\u4EA4\u6613\u5230\u533A\u5757\u94FE\u2026")):n.status==2?(i(),p("div",Ee,"\u7B49\u5F85\u670D\u52A1\u5668\u540C\u6B65...")):n.status==-1?(i(),p("div",De,"\u4E0A\u94FE\u4EA4\u6613\u53D1\u9001\u5931\u8D25")):n.status==-2?(i(),p("div",Re,"\u670D\u52A1\u5668\u540C\u6B65\u8D85\u65F6")):ee("",!0)],64)):ee("",!0)]),l("div",We,[n.status==1||n.status==2?(i(),y(K,{key:0,type:"spinner",size:"48px"})):n.status==0?(i(),y(P,{key:1,color:"#07c160",size:"40px",name:"checked"})):n.status==-1||n.status==-2?(i(),y(P,{key:2,color:"#FA5151",size:"40px",name:"clear"})):ee("",!0)]),n.tradeHash?(i(),p("div",{key:0,class:"trade-hash",onClick:$[0]||($[0]=x=>k(ue)(n.tradeHash))},[_("\u4EA4\u6613Hash: "),l("span",Oe,b(k(ce)(n.tradeHash)),1),t(V,{name:"copy"})])):(i(),p("div",je,"\u4EA4\u6613Hash: N/A"))])]),_:1},8,["show"])}}},Je=ve(qe,[["__scopeId","data-v-4d8c2315"]]);const F=n=>(de("data-v-12e5f029"),n=n(),re(),n),Ke={class:"body"},Ge={class:"tools-bar"},Me={key:0,class:"address"},Qe={class:"address-text"},Xe=F(()=>l("div",null,"\u8BF7\u8FDE\u63A5\u94B1\u5305",-1)),Ye={class:"tools"},Ze={class:"token"},ea={class:"token-symbol"},aa={class:"amount"},ta={style:{"margin-left":"4px"}},la=F(()=>l("svg",{class:"icon","aria-hidden":"true"},[l("use",{"xlink:href":"#icon-redPacket"})],-1)),oa={key:0};const sa={class:"form-item total-amount"},na={class:"form-item create"},ia=F(()=>l("div",{class:"content"},[l("div",null,"1: \u62FC\u624B\u6C14\u7EA2\u5305, \u9886\u53D6\u91D1\u989D\u968F\u673A, \u666E\u901A\u7EA2\u5305\u5219\u6BCF\u4E2A\u7EA2\u5305\u7684\u91D1\u989D\u5747\u76F8\u7B49\u3002"),l("div",null,"2: \u7EA2\u5305\u5230\u671F\u540E, \u5C06\u65E0\u6CD5\u88AB\u9886\u53D6, \u5269\u4F59\u91D1\u989D\u5C06\u539F\u8DEF\u9000\u8FD8\u3002"),l("div",null,"3: \u7EA2\u5305\u5230\u671F\u540E, \u667A\u80FD\u5408\u7EA6\u5C06\u81EA\u52A8\u4E3A\u5DF2\u9886\u53D6\u7528\u6237\u53D1\u653E\u4EE3\u5E01, \u5230\u8D26\u65F6\u95F4\u4EE5\u94FE\u4E0A\u5B8C\u6210\u65F6\u95F4\u4E3A\u51C6\u3002"),l("div",null,"4: \u56E0\u94FE\u4E0AGAS\u8D39\u7528, \u652F\u4ED8\u91D1\u989D\u4E00\u822C\u4F1A\u5927\u4E8E\u7EA2\u5305\u603B\u91D1\u989D\u3002"),l("div",null,"5: \u7EA2\u5305\u521B\u5EFA\u529F\u80FD, \u76EE\u524D\u652F\u6301BSC/OKC/HECO\u94FE\u3002")],-1)),ca={class:"content"},ua={class:"success-icon"},da=F(()=>l("div",{class:"title"},"\u606D\u559C\uFF0C\u7EA2\u5305\u521B\u5EFA\u6210\u529F~",-1)),ra=F(()=>l("div",{class:"text"},"\u8F6C\u53D1\u9886\u53D6\u94FE\u63A5\uFF0C\u7528\u6237\u53EF\u4F7F\u7528AveAPP\u6216\u5176\u4ED6\u94B1\u5305\u7C7BAPP\u6253\u5F00\u94FE\u63A5\u75C5\u9886\u53D6\u7EA2\u5305",-1)),va={class:"btn"},ma=F(()=>l("div",{class:"content"},[l("div",null,"\u6682\u4E0D\u652F\u6301\u6B64\u94FE\uFF0C"),l("div",null,"\u8BF7\u5207\u6362\u81F3ETH\u3001BSC\u3001OKC\u3001HECO")],-1)),fa={__name:"Index",setup(n){const le=Se(),r=Ie(),{t:$}=Be(),K=Ne("global"),P=u(!1),z=u(!1),x=u(!1),R=u(!1),S=u(0),L=u(""),T=u(""),I=u("");u("");const G=u(""),E=u("");console.log(K.cfg);const me=ie(()=>S.value==0?L.value?L.value:"0.00":T.value&&I.value?te(Number(T.value)).multipliedBy(Number(I.value)).toNumber().toString():"0.00"),g=u(!1),w=u(0),H=u(""),M=u(!1),W=u(!1),Q=u(""),oe=u(!1),fe=ie(()=>[{name:$("languages.zh-cn"),value:"zh-cn",color:r.language==="zh-cn"?"#9505F9":"#323233"},{name:$("languages.en"),value:"en",color:r.language==="en"?"#9505F9":"#323233"}]);function _e(s){r.setLanguage(s.value)}const X=u([]),d=ae({symbol:"JF",icon:"https://static.debank.com/image/bsc_token/logo_url/0x5fac926bf1e638944bb16fb5b787b5ba4bc85b0a/74d0d0f5a5fcf76ab35b89b29cb9c95e.png",amount:9999999,address:"0x227A05695F10B591731Fd925396b548a45067798",chain:"bsc",chainId:97}),D=u(!1),pe=ae([{text:"5 \u5206\u949F",value:300},{text:"10 \u5206\u949F",value:600}]),U=ae({text:"5 \u5206\u949F",value:300});function he(s,e){console.log(s),Le(s)}function be(s){U.text=s.text,U.value=s.value,D.value=!1}async function ge(){const s=r.chainId;if(s==97){X.value=[{symbol:"JF",icon:"https://static.debank.com/image/bsc_token/logo_url/0x5fac926bf1e638944bb16fb5b787b5ba4bc85b0a/74d0d0f5a5fcf76ab35b89b29cb9c95e.png",amount:9999999,address:"0x227A05695F10B591731Fd925396b548a45067798",chain:"bsc",chainId:97}];return}let f=(await N.wallet.getWalletTokenList(r.walletAddress,N.wallet.ALLOW_CHAINS[s])).data.filter(c=>new RegExp("^0x.*$","gi").test(c.id)).map(c=>({address:c.id.toLowerCase(),tokenId:`${c.id}-${c.chain}`.toLowerCase(),chain:c.chain.toLowerCase(),symbol:c.symbol,decimals:c.decimals,icon:c.logo_url,amount:c.amount,chainId:s}));console.dir(f);let v=f.map(c=>c.tokenId),B=await N.redPacket.tokenlistcheck(v);X.value=f.filter(c=>B.data[c.tokenId].riskScore<60)}function ke(s){d.symbol=s.symbol,d.icon=s.icon,d.amount=s.amount,d.address=s.address,d.chain=s.chain,d.chainId=s.chainId,R.value=!1}async function se(){await r.connectWallet(),await ne()}function ye(){return!0}async function we(){g.value=!1,H.value="",w.value=1,g.value=!0;try{let s=await N.wallet.approveMaxAmount(d.address,r.redPacketContractAddress);console.log(s),x.value=!1,H.value=s.hash,w.value=0}catch{w.value=-1,await j(2e3)}finally{g.value=!1}}async function ne(){await N.wallet.isAllowanceEnough(r.redPacketContractAddress,d.address,r.walletAddress)?x.value=!1:x.value=!0}async function xe(){M.value=!0,await Ce(),M.value=!1}async function Ce(){if(g.value=!1,H.value="",W.value=!1,Q.value="",S.value==0){if(!L.value){q.fail("\u8BF7\u8F93\u5165\u603B\u91D1\u989D");return}}else if(!T.value){q.fail("\u8BF7\u8F93\u5165\u5355\u4E2A\u91D1\u989D");return}if(!I.value){q.fail("\u8BF7\u8F93\u5165\u6570\u91CF");return}let s;if(S.value==0?s=te(Number(L.value)).toNumber():s=te(Number(T.value)).multipliedBy(Number(I.value)).toNumber(),E.value||(E.value="\u606D\u559C\u53D1\u8D22, \u5927\u5409\u5927\u5229"),!ye())return;if(await ne(),x.value){q.fail("\u8BF7\u5148Approve");return}w.value=1,g.value=!0;let f;try{let v=await N.wallet.sendRedPacket(r.redPacketContractAddress,d.address,S.value,s.toString(),I.value,U.value);console.dir(v),H.value=v.hash,f=await v.wait(),console.dir(f),H.value=f.transactionHash}catch(v){console.log(v),w.value=-1,await j(1e3),g.value=!1;return}w.value=2;try{let v=f==null?void 0:f.events,B={};for(let C=v.length-1;C>=0;C--){let A=v[C].topics.some(Y=>Y==="0x694af1cc8727cdd0afbdd53d9b87b69248bd490224e9dd090e788546506e076f");if(v[C].address==r.redPacketContractAddress&&A){B=v[C];break}}let c=await N.redPacket.send(d.address,d.chain,B.topics[1],f.transactionHash,U.value,E.value,d.symbol,G.value);console.dir(c),w.value=0,await j(500),g.value=!1;const h=c.data.uuid;W.value=!0,Q.value=window.location.origin+"/redpacket/"+h}catch(v){console.log(v),w.value=-1,await j(1e3),g.value=!1}}return r.isConnectWallet&&ge(),(s,e)=>{const f=m("van-radio"),v=m("van-radio-group"),B=m("van-icon"),c=m("van-cell"),h=m("van-cell-group"),C=m("van-action-sheet"),A=m("van-field"),Y=m("van-picker"),Ae=m("van-popup"),_a=m("van-image"),Ve=m("van-uploader"),O=m("van-button"),Z=m("van-dialog");return i(),p(J,null,[l("div",Ke,[l("div",Ge,[k(r).isConnectWallet?(i(),p("div",Me,[t(V,{name:"mbox"}),l("div",Qe,b(k(ce)(k(r).walletAddress)),1)])):(i(),p("div",{key:1,class:"address",onClick:se},[t(V,{name:"wallet"}),Xe])),l("div",Ye,[t(V,{name:"language",onClick:e[0]||(e[0]=a=>z.value=!0)}),t(V,{name:"help",onClick:e[1]||(e[1]=a=>P.value=!0)})])]),t(v,{modelValue:S.value,"onUpdate:modelValue":e[2]||(e[2]=a=>S.value=a),direction:"horizontal",class:"type form-item"},{default:o(()=>[t(f,{name:0,"checked-color":"#ED4A4A","icon-size":"16px"},{default:o(()=>[_(b(s.$t("randomAmount")),1)]),_:1}),t(f,{name:1,"checked-color":"#ED4A4A","icon-size":"16px"},{default:o(()=>[_(b(s.$t("identicalAmount")),1)]),_:1})]),_:1},8,["modelValue"]),t(h,{inset:"",class:"form-item form-normal"},{default:o(()=>[t(c,{title:"\u5E01\u79CD","is-link":"",onClick:e[3]||(e[3]=a=>R.value=!0)},{value:o(()=>[l("div",null,[t(B,{name:d.icon},null,8,["name"]),_(" "+b(d.symbol),1)])]),_:1}),t(C,{show:R.value,"onUpdate:show":e[4]||(e[4]=a=>R.value=a),title:"\u8BBE\u7F6E\u5E01\u79CD"},{default:o(()=>[l("div",Ze,[t(h,{inset:""},{default:o(()=>[(i(!0),p(J,null,Pe(X.value,a=>(i(),y(c,{key:a.address,clickable:"",onClick:pa=>ke(a)},{title:o(()=>[l("div",ea,[t(B,{class:"symbol-icon",name:d.icon},null,8,["name"]),l("span",null,b(a.symbol),1)])]),value:o(()=>[l("div",null,[l("span",null,b("\u4F59\u989D")+": "+b(a.amount),1),_("\xA0\xA0 ")])]),_:2},1032,["onClick"]))),128))]),_:1})])]),_:1},8,["show"])]),_:1}),S.value==0?(i(),y(h,{key:0,inset:"",class:"form-item form-normal"},{default:o(()=>[t(A,{label:"\u603B\u91D1\u989D","input-align":"right",placeholder:"\u8F93\u5165\u91D1\u989D",type:"number",modelValue:L.value,"onUpdate:modelValue":e[5]||(e[5]=a=>L.value=a)},{"left-icon":o(()=>[t(V,{name:"pin"})]),_:1},8,["modelValue"])]),_:1})):(i(),y(h,{key:1,inset:"",class:"form-item form-normal"},{default:o(()=>[t(A,{label:"\u5355\u4E2A\u91D1\u989D","input-align":"right",placeholder:"\u8F93\u5165\u91D1\u989D",type:"number",modelValue:T.value,"onUpdate:modelValue":e[6]||(e[6]=a=>T.value=a)},{"left-icon":o(()=>[t(V,{name:"pu"})]),_:1},8,["modelValue"])]),_:1})),l("div",aa,[_(" \u53EF\u7528\u4F59\u989D"),l("span",ta,b(d.amount+" "+d.symbol),1)]),t(h,{inset:"",class:"form-item form-normal"},{default:o(()=>[t(A,{label:"\u7EA2\u5305\u4E2A\u6570","input-align":"right",placeholder:"\u8F93\u5165\u4E2A\u6570",type:"digit",modelValue:I.value,"onUpdate:modelValue":e[7]||(e[7]=a=>I.value=a)},{"left-icon":o(()=>[la]),"right-icon":o(()=>[_("\u4E2A")]),_:1},8,["modelValue"])]),_:1}),t(h,{inset:"",class:"form-item form-normal"},{default:o(()=>[t(A,{modelValue:U.text,"onUpdate:modelValue":e[8]||(e[8]=a=>U.text=a),"is-link":"",readonly:"",name:"picker",label:"\u8FC7\u671F\u65F6\u95F4",onClick:e[9]||(e[9]=a=>D.value=!0),"input-align":"right"},null,8,["modelValue"]),t(Ae,{show:D.value,"onUpdate:show":e[11]||(e[11]=a=>D.value=a),position:"bottom"},{default:o(()=>[t(Y,{columns:pe,onCancel:e[10]||(e[10]=a=>D.value=!1),onConfirm:be,title:"\u8BBE\u7F6E\u8FC7\u671F\u65F6\u95F4","confirm-button-text":"\u786E\u8BA4","cancel-button-text":"\u53D6\u6D88"},null,8,["columns"])]),_:1},8,["show"])]),_:1}),t(h,{inset:"",class:"form-item form-normal"},{default:o(()=>[t(Ve,{class:"uploader-box","before-read":he,"max-size":1024*1024,"preview-image":!1,accept:"image/*"},{default:o(()=>[t(c,{class:"uploader-content","is-link":"",title:"\u7EA2\u5305\u5C01\u9762\uFF08\u9009\u586B\uFF09"},{value:o(()=>[(i(),p("div",oa," \u9009\u62E9\u56FE\u7247 "))]),_:1})]),_:1})]),_:1}),t(h,{inset:"",class:"form-item"},{default:o(()=>[t(A,{modelValue:E.value,"onUpdate:modelValue":e[12]||(e[12]=a=>E.value=a),rows:"1",autosize:"",type:"textarea",maxlength:"20",placeholder:"\u606D\u559C\u53D1\u8D22, \u5927\u5409\u5927\u5229","show-word-limit":""},null,8,["modelValue"])]),_:1}),t(h,{inset:"",class:"form-item"},{default:o(()=>[t(A,{modelValue:G.value,"onUpdate:modelValue":e[13]||(e[13]=a=>G.value=a),rows:"2",autosize:"",type:"textarea",maxlength:"500",placeholder:"\u6D3B\u52A8\u8BF4\u660E(\u9009\u586B), \u6700\u591A500\u5B57"},null,8,["modelValue"])]),_:1}),l("div",sa,[_(" \u7EA2\u5305\u603B\u989D"),l("span",null,b(k(me)),1),_(b(d.symbol),1)]),l("div",na,[k(r).isConnectWallet?(i(),p(J,{key:0},[x.value?(i(),y(O,{key:0,class:"create-btn",type:"danger",onClick:we},{default:o(()=>[_("Approve")]),_:1})):(i(),y(O,{key:1,class:"create-btn",type:"danger",onClick:xe,loading:M.value},{default:o(()=>[_("\u521B\u5EFA\u7EA2\u5305")]),_:1},8,["loading"]))],64)):(i(),y(O,{key:1,class:"create-btn",type:"primary",onClick:se},{default:o(()=>[_("\u8FDE\u63A5\u94B1\u5305")]),_:1}))]),l("div",{class:"form-item history",onClick:e[14]||(e[14]=a=>k(le).push("/history"))},"\u7EA2\u5305\u5386\u53F2")]),t(Z,{class:"help-dialog",show:P.value,"onUpdate:show":e[15]||(e[15]=a=>P.value=a),title:"\u89C4\u5219\u8BF4\u660E","confirm-button-text":"\u77E5\u9053\u4E86","close-on-click-overlay":""},{default:o(()=>[ia]),_:1},8,["show"]),t(Z,{class:"create-success-dialog",show:W.value,"onUpdate:show":e[17]||(e[17]=a=>W.value=a),"close-on-click-overlay":""},{footer:o(()=>[l("div",va,[t(O,{class:"copy-btn",type:"primary",onClick:e[16]||(e[16]=a=>k(ue)(Q.value))},{default:o(()=>[_("\u590D\u5236\u7EA2\u5305\u94FE\u63A5")]),_:1})])]),default:o(()=>[l("div",ca,[l("div",ua,[t(V,{name:"createSuccess"})]),da,ra])]),_:1},8,["show"]),t(C,{show:z.value,"onUpdate:show":e[18]||(e[18]=a=>z.value=a),title:s.$t("switchLang"),actions:k(fe),closeable:!1,"cancel-text":"\u53D6\u6D88","close-on-click-action":"",onSelect:_e},null,8,["show","title","actions"]),t(Je,{tradeVisable:g.value,"onUpdate:tradeVisable":e[19]||(e[19]=a=>g.value=a),status:w.value,tradeHash:H.value},null,8,["tradeVisable","status","tradeHash"]),t(Z,{class:"chain-err-dialog",confirmButtonText:"\u6211\u77E5\u9053\u4E86",confirmButtonColor:"#3F80F7",show:oe.value,"onUpdate:show":e[20]||(e[20]=a=>oe.value=a)},{default:o(()=>[ma]),_:1},8,["show"])],64)}}},ka=ve(fa,[["__scopeId","data-v-12e5f029"]]);export{ka as default};
