import{d as w,T as x}from"./dayjs.min.ae32e371.js";import{_ as C}from"./TokenIcon.vuevuetypestyleindex0scoped7bbb7138lang.7520dbc5.js";import{l as L,k as V,q as u,I as D,s as M,r as R,o as i,b as o,a as e,M as Y,d as l,t as v,u as a,g as _,e as P,w as W,N as j,T as z,x as O,O as A,f as q,p as E,j as F}from"./index.299ad1bc.js";import{u as G}from"./redPacketStore.29bdea6e.js";import{_ as J}from"./plugin-vueexport-helper.2444895f.js";const h=p=>(E("data-v-c04dab9c"),p=p(),F(),p),K={class:"body"},Q={class:"top"},U=j('<div class="background" data-v-c04dab9c><div style="--i:1;" data-v-c04dab9c></div><div style="--i:2;" data-v-c04dab9c></div><div style="--i:3;" data-v-c04dab9c></div><div style="--i:4;" data-v-c04dab9c></div><div style="--i:5;" data-v-c04dab9c></div><div style="--i:6;" data-v-c04dab9c></div><div style="--i:7;" data-v-c04dab9c></div><div style="--i:8;" data-v-c04dab9c></div><div style="--i:9;" data-v-c04dab9c></div><div style="--i:10;" data-v-c04dab9c></div><div style="--i:11;" data-v-c04dab9c></div><div style="--i:12;" data-v-c04dab9c></div><div style="--i:13;" data-v-c04dab9c></div><div style="--i:14;" data-v-c04dab9c></div><div style="--i:15;" data-v-c04dab9c></div><div style="--i:16;" data-v-c04dab9c></div><div style="--i:17;" data-v-c04dab9c></div><div style="--i:18;" data-v-c04dab9c></div><div style="--i:19;" data-v-c04dab9c></div><div style="--i:20;" data-v-c04dab9c></div><div style="--i:21;" data-v-c04dab9c></div><div style="--i:22;" data-v-c04dab9c></div><div style="--i:23;" data-v-c04dab9c></div><div style="--i:24;" data-v-c04dab9c></div><div style="--i:25;" data-v-c04dab9c></div><div style="--i:26;" data-v-c04dab9c></div><div style="--i:27;" data-v-c04dab9c></div><div style="--i:28;" data-v-c04dab9c></div><div style="--i:29;" data-v-c04dab9c></div><div style="--i:30;" data-v-c04dab9c></div><div style="--i:31;" data-v-c04dab9c></div><div style="--i:32;" data-v-c04dab9c></div><div style="--i:33;" data-v-c04dab9c></div><div style="--i:34;" data-v-c04dab9c></div><div style="--i:35;" data-v-c04dab9c></div><div style="--i:36;" data-v-c04dab9c></div></div>',1),X={class:"info-box"},Z={key:0,class:"fold-operate-fixed"},ee=h(()=>e("span",{class:"dot"},"...",-1)),te={class:"fold-text"},se={class:"red-packet"},ae={class:"circle-big"},de={class:"circle-small"},ie={key:0,class:"card"},oe={class:"from"},ce={class:"amount"},le={class:"congratulation"},ve={class:"text"},ne={key:0,class:"logo"},re={key:1},ue={class:"text-top"},_e={class:"from"},ye={class:"congratulation"},he={key:0,class:"front-cover"},pe={class:"text-middle"},fe={key:0},be=h(()=>e("div",null,"\u54CE\u5440\u624B\u6162\u4E86",-1)),me=h(()=>e("div",null,"\u7EA2\u5305\u62A2\u5B8C\u4E86",-1)),ke=[be,me],ge={key:1},we=h(()=>e("div",null,"\u54CE\u5440\u624B\u6162\u4E86",-1)),xe=h(()=>e("div",null,"\u7EA2\u5305\u5DF2\u8FC7\u671F",-1)),Ce=[we,xe],Re={class:"text-bottom"},Pe={key:0,class:"award-time"},Ae={class:"bottom"},He={class:"logo"},Ie={__name:"ReceiveRedPacket",setup(p){const t=G(),n=L(),m=V(),k=u(!1),y=u(!0),r=u(null),f=u(null),d=u(0),b=u("--");D(async()=>{let s=f.value.scrollHeight,c=f.value.offsetHeight;s>c&&(k.value=!0),document.body.style.setProperty("--top-height",r.value.scrollHeight-20+"px"),window.onresize=()=>(console.log("\u9AD8\u5EA6"),(()=>{console.log(r.value.scrollHeight),document.body.style.setProperty("--top-height",r.value.scrollHeight-20+"px")})())});async function H(){console.log("openClick");const s=z.loading();try{await I()}catch(c){console.log(c)}finally{s.clear()}}async function I(){if(!n.isConnectWallet){if(await n.connectWallet(),!n.isConnectWallet)return;await t.getRedPacketDetail(t.uuid,n.walletAddress)}if(t.isReceived){const s=t.receiveList.find(c=>c.userAddress==n.walletAddress);b.value=s.amount,d.value=1;return}if(console.log(t.status),t.status==3)try{const s=await O.redPacket.receive(n.walletAddress,t.uuid);console.log(s),s.status==1&&s.data.status==3&&(t.isReceived=!0,b.value=s.data.receiveResult.amount,d.value=1,t.receiveList.push({transferTime:w().unix(),amount:s.data.receiveResult.amount,userAddress:s.data.receiveResult.userAddress}))}catch(s){console.log(s),d.value=2}else t.count==t.receiveList.length?d.value=2:d.value=3}async function S(){y.value=!1,await A(),document.body.style.setProperty("--top-height",r.value.scrollHeight-20+"px")}async function T(){y.value=!0,await A(),document.body.style.setProperty("--top-height",r.value.scrollHeight-20+"px")}const g=M(()=>t.creatorAddress?t.creatorAddress.substr(-4).toLowerCase():"--");return(s,c)=>{const B=R("van-image"),N=R("van-button");return i(),o("div",K,[e("div",Q,[U,e("div",{class:"content",ref_key:"content",ref:r},[e("div",X,[e("div",{class:Y(["info",{fold:y.value}]),ref_key:"info",ref:f},[k.value&&y.value?(i(),o("div",Z,[ee,e("span",{class:"fold-operate",onClick:S},"\u5C55\u5F00")])):l("",!0),e("span",te,v(a(t).title),1),y.value?l("",!0):(i(),o("span",{key:1,class:"fold-operate",onClick:T},"\u6536\u8D77"))],2)]),e("div",se,[e("div",ae,[e("div",de,[d.value==1?(i(),o("div",ie,[e("div",oe,[_(x,{class:"token-icon"}),e("span",null,v(s.$t("redPacketBelong",{user:a(g)})),1)]),e("div",ce,v(b.value+" "+a(t).symbol),1),e("div",le,v(a(t).remark),1)])):l("",!0)])]),e("div",ve,[d.value!=1?(i(),o("div",ne,[_(C,{class:"icon",name:"logo"})])):l("",!0),d.value!=1?(i(),o("div",re,[e("div",ue,[e("div",_e,[_(x,{class:"token-icon"}),P(v()+" ",1),e("span",null,"*"+v(s.$t("redPacketBelong",{user:a(g)})),1)]),e("div",ye,v(a(t).remark),1)]),d.value==0&&a(t).coverImage?(i(),o("div",he,[_(B,{class:"img",fit:"contain",src:a(t).coverImage},null,8,["src"])])):l("",!0),d.value==0?(i(),o("div",{key:1,class:"open",onClick:H},"\u958B")):l("",!0),e("div",pe,[d.value==2?(i(),o("div",fe,ke)):l("",!0),d.value==3?(i(),o("div",ge,Ce)):l("",!0)])])):l("",!0),e("div",Re,[d.value==1?(i(),o("div",Pe,"*\u7EA2\u5305\u91D1\u989D\u5C06\u5728"+v(a(w).unix(a(t).sendTime).format("YYYY-MM-DD HH:mm"))+"\u5206\u5F00\u59CB\u53D1\u653E\uFF0C\u8F6C\u5165"+v(a(q)(a(n).walletAddress))+"\u5730\u5740\uFF0C\u5177\u4F53\u65F6\u95F4\u4EE5\u94FE\u4E0A\u5230\u8D26\u4E3A\u51C6",1)):l("",!0),e("div",{class:"show-luck",onClick:c[0]||(c[0]=$=>a(m).push(`/redpacket/${a(t).uuid}/showLuck`))},"\u67E5\u770B\u5927\u5BB6\u624B\u6C14 >")])])])],512)]),e("div",Ae,[_(N,{class:"send-red-packet",onClick:c[1]||(c[1]=$=>a(m).push("/"))},{default:W(()=>[P("\u6211\u4E5F\u8981\u53D1\u7EA2\u5305")]),_:1}),e("div",He,[_(C,{class:"icon",name:"logo"})])])])}}},Le=J(Ie,[["__scopeId","data-v-c04dab9c"]]);export{Le as default};
