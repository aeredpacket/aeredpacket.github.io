import{T as O}from"./TokenIcon.b02ca206.js";import{_ as M,m as R,j,k as q,l as U,n as f,q as y,s as W,r as m,o as i,b as p,g as C,a as o,t as r,F as T,K as I,u as n,w as g,O as z,c as B,C as K,f as P,B as w,d as G,T as H,v as b,L as J}from"./index.8581d43f.js";const Q={class:"content"},X={class:"p-16"},Y={class:"network"},Z={class:"network-list"},ee=["onClick"],te={class:"item-left"},se={class:"left-content"},oe={class:"token-name"},ne={class:"token-address"},ae={class:"item-right"},le={class:"item-right-left"},ce={class:"qty"},ie={class:"amount"},re={class:"item-right-right"},de={__name:"SelectToken",setup(ue){const A=R("global"),x=j(),v=q();U();const F=f([]),k=f([]),l=f(""),$=y(()=>l.value?l.value.startsWith("0x")?k.value.filter(e=>e.address.toLowerCase()==l.value.toLowerCase()):k.value.filter(e=>e.symbol.toLowerCase().indexOf(l.value.toLowerCase())>-1):k.value),h={text:"BSC",value:"bsc",isAllow:!0},d=f({text:h.text,value:h.value,isAllow:h.isAllow}),E=y(()=>{let e=[h];for(let a of F.value){let c=A.cfg.allowChainList.some(_=>_.chain==a.chain),u={text:a.chain.toUpperCase(),value:a.chain,isAllow:c};e.push(u)}return e});async function S(e){!e.isAllow||d.value.value!=e.value&&(d.value=e,L())}async function L(){let e=[];const a=H.loading({message:"Loading...",forbidClick:!0,duration:0});d.value.value=="all"?e=await b.debank.getAllTokenList("0x1fB48E044aDf8Eb0dC5803DFEC5589A2B1c385F4"):e=await b.debank.getTokenList("0x1fB48E044aDf8Eb0dC5803DFEC5589A2B1c385F4",d.value.value);let c=e.data.filter(t=>new RegExp("^0x.*$","gi").test(t.id)).map(t=>({address:t.id.toLowerCase(),tokenId:`${t.id}-${t.chain}`.toLowerCase(),chain:t.chain.toLowerCase(),symbol:t.symbol,decimals:t.decimals,icon:J(t.chain.toLowerCase(),t.id.toLowerCase()),amount:t.amount,price:t.price})),u=c.map(t=>t.tokenId),_=await b.redPacket.tokenlistcheck(u);a.clear(),k.value=c.filter(t=>_.data[t.tokenId].riskScore<60)}function N(e){v.token=e,x.push("/")}async function V(){v.isConnectWallet&&await L()}return W(()=>{console.log("onMounted"),V()}),(e,a)=>{const c=m("van-search"),u=m("van-icon"),_=m("van-cell"),t=m("van-list");return i(),p("div",null,[C(c,{modelValue:l.value,"onUpdate:modelValue":a[0]||(a[0]=s=>l.value=s),shape:"round","show-action":"",placeholder:e.$t("searchTokenContractOrName"),"action-text":e.$t("cancel")},null,8,["modelValue","placeholder","action-text"]),o("div",Q,[o("div",X,r(e.$t("myAssets")),1),o("div",Y,[o("ul",Z,[(i(!0),p(T,null,I(n(E),s=>(i(),p("li",{class:z(d.value.value==s.value?"network-selected":""),onClick:D=>S(s)},r(s.text),11,ee))),256))])]),o("div",null,[C(t,{"finished-text":e.$t("noMore"),class:"token-list"},{default:g(()=>[(i(!0),p(T,null,I(n($),s=>(i(),B(_,{class:"item",key:s,onClick:D=>N(s)},{title:g(()=>[o("div",te,[C(O,{class:"token-icon",tokenIcon:s.icon,chainIcon:n(K)(s.chain)},null,8,["tokenIcon","chainIcon"]),o("div",se,[o("div",oe,r(s.symbol),1),o("div",ne,r(n(P)(s.address)),1)])])]),value:g(()=>[o("div",ae,[o("div",le,[o("div",ce,r(n(w)(s.amount).toString().indexOf(".")==-1?n(w)(s.amount):n(w)(s.amount).toFixed(6)),1),o("div",ie,"$"+r(n(w)(s.amount).multipliedBy(s.price).toFixed(2)),1)]),o("div",re,[n(v).token&&n(v).token.address==s.address?(i(),B(u,{key:0,name:"success",color:"#3F80F7"})):G("",!0)])])]),_:2},1032,["onClick"]))),128))]),_:1},8,["finished-text"])])])])}}},ke=M(de,[["__scopeId","data-v-8b67b41b"]]);export{ke as default};
