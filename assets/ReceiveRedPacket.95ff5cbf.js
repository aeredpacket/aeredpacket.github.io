import{T as x}from"./TokenIcon.acce3039.js";import{_ as b}from"./TokenIcon.vue_vue_type_style_index_0_scoped_7bbb7138_lang.7a46c07c.js";import{l as B,k as D,m as u,E as Y,n as $,r as C,o as i,b as o,a as e,I as z,d as v,t as c,u as a,g as f,e as R,w as M,J as W,T as j,s as E,z as A,K as H,f as F,p as J,j as K}from"./index.4ee347b9.js";import{u as O}from"./redPacketStore.3605da73.js";import{_ as q}from"./_plugin-vue_export-helper.cdc0426e.js";const y=h=>(J("data-v-af62d138"),h=h(),K(),h),G={class:"body"},Q={class:"top"},U=W('<div class="background" data-v-af62d138><div style="--i:1;" data-v-af62d138></div><div style="--i:2;" data-v-af62d138></div><div style="--i:3;" data-v-af62d138></div><div style="--i:4;" data-v-af62d138></div><div style="--i:5;" data-v-af62d138></div><div style="--i:6;" data-v-af62d138></div><div style="--i:7;" data-v-af62d138></div><div style="--i:8;" data-v-af62d138></div><div style="--i:9;" data-v-af62d138></div><div style="--i:10;" data-v-af62d138></div><div style="--i:11;" data-v-af62d138></div><div style="--i:12;" data-v-af62d138></div><div style="--i:13;" data-v-af62d138></div><div style="--i:14;" data-v-af62d138></div><div style="--i:15;" data-v-af62d138></div><div style="--i:16;" data-v-af62d138></div><div style="--i:17;" data-v-af62d138></div><div style="--i:18;" data-v-af62d138></div><div style="--i:19;" data-v-af62d138></div><div style="--i:20;" data-v-af62d138></div><div style="--i:21;" data-v-af62d138></div><div style="--i:22;" data-v-af62d138></div><div style="--i:23;" data-v-af62d138></div><div style="--i:24;" data-v-af62d138></div><div style="--i:25;" data-v-af62d138></div><div style="--i:26;" data-v-af62d138></div><div style="--i:27;" data-v-af62d138></div><div style="--i:28;" data-v-af62d138></div><div style="--i:29;" data-v-af62d138></div><div style="--i:30;" data-v-af62d138></div><div style="--i:31;" data-v-af62d138></div><div style="--i:32;" data-v-af62d138></div><div style="--i:33;" data-v-af62d138></div><div style="--i:34;" data-v-af62d138></div><div style="--i:35;" data-v-af62d138></div><div style="--i:36;" data-v-af62d138></div></div>',1),X={class:"info-box"},Z={key:0,class:"fold-operate-fixed"},ee=y(()=>e("span",{class:"dot"},"...",-1)),te={class:"fold-text"},se={class:"red-packet"},ae={class:"circle-big"},de={class:"circle-small"},ie={key:0,class:"card"},oe={class:"from"},le={class:"amount"},ve={class:"congratulation"},ce={class:"text"},ne={key:0,class:"logo"},re={key:1},ue={class:"text-top"},fe={class:"from"},_e={class:"congratulation"},ye={key:0,class:"front-cover"},he={class:"text-middle"},pe={key:0},me=y(()=>e("div",null,"\u54CE\u5440\u624B\u6162\u4E86",-1)),ke=y(()=>e("div",null,"\u7EA2\u5305\u62A2\u5B8C\u4E86",-1)),ge=[me,ke],we={key:1},xe=y(()=>e("div",null,"\u54CE\u5440\u624B\u6162\u4E86",-1)),be=y(()=>e("div",null,"\u7EA2\u5305\u5DF2\u8FC7\u671F",-1)),Ce=[xe,be],Re={class:"text-bottom"},Ae={key:0,class:"award-time"},He={class:"bottom"},Pe={class:"logo"},Ie={__name:"ReceiveRedPacket",setup(h){const t=O(),n=B(),k=D(),g=u(!1),_=u(!0),r=u(null),p=u(null),d=u(0),m=u("--");Y(async()=>{let s=p.value.scrollHeight,l=p.value.offsetHeight;s>l&&(g.value=!0),document.body.style.setProperty("--top-height",r.value.scrollHeight-20+"px"),window.onresize=()=>(console.log("\u9AD8\u5EA6"),(()=>{console.log(r.value.scrollHeight),document.body.style.setProperty("--top-height",r.value.scrollHeight-20+"px")})())});async function P(){console.log("openClick");const s=j.loading();try{await I()}catch(l){console.log(l)}finally{s.clear()}}async function I(){if(!n.isConnectWallet){if(await n.connectWallet(),!n.isConnectWallet)return;await t.getRedPacketDetail(t.uuid,n.walletAddress)}if(t.isReceived){const s=t.receiveList.find(l=>l.userAddress==n.walletAddress);m.value=s.amount,d.value=1;return}if(console.log(t.status),t.status==3)try{const s=await E.redPacket.receive(n.walletAddress,t.uuid);console.log(s),s.status==1&&s.data.status==3&&(t.isReceived=!0,m.value=s.data.receiveResult.amount,d.value=1,t.receiveList.push({transferTime:A().unix(),amount:s.data.receiveResult.amount,userAddress:s.data.receiveResult.userAddress}))}catch(s){console.log(s),d.value=2}else t.count==t.receiveList.length?d.value=2:d.value=3}async function S(){_.value=!1,await H(),document.body.style.setProperty("--top-height",r.value.scrollHeight-20+"px")}async function T(){_.value=!0,await H(),document.body.style.setProperty("--top-height",r.value.scrollHeight-20+"px")}const w=$(()=>t.creatorAddress?t.creatorAddress.substr(-4).toLowerCase():"--");return(s,l)=>{const L=C("van-image"),N=C("van-button");return i(),o("div",G,[e("div",Q,[U,e("div",{class:"content",ref_key:"content",ref:r},[e("div",X,[e("div",{class:z(["info",{fold:_.value}]),ref_key:"info",ref:p},[g.value&&_.value?(i(),o("div",Z,[ee,e("span",{class:"fold-operate",onClick:S},"\u5C55\u5F00")])):v("",!0),e("span",te,c(a(t).title),1),_.value?v("",!0):(i(),o("span",{key:1,class:"fold-operate",onClick:T},"\u6536\u8D77"))],2)]),e("div",se,[e("div",ae,[e("div",de,[d.value==1?(i(),o("div",ie,[e("div",oe,[f(x,{class:"token-icon"}),e("span",null,c(a(w))+"\u7684\u7EA2\u5305",1)]),e("div",le,c(m.value+" "+a(t).symbol),1),e("div",ve,c(a(t).remark),1)])):v("",!0)])]),e("div",ce,[d.value!=1?(i(),o("div",ne,[f(b,{class:"icon",name:"logo"})])):v("",!0),d.value!=1?(i(),o("div",re,[e("div",ue,[e("div",fe,[f(x,{class:"token-icon"}),R(c()+" ",1),e("span",null,"*"+c(a(w))+"\u7684\u7EA2\u5305",1)]),e("div",_e,c(a(t).remark),1)]),d.value==0&&a(t).coverImage?(i(),o("div",ye,[f(L,{class:"img",fit:"contain",src:a(t).coverImage},null,8,["src"])])):v("",!0),d.value==0?(i(),o("div",{key:1,class:"open",onClick:P},"\u958B")):v("",!0),e("div",he,[d.value==2?(i(),o("div",pe,ge)):v("",!0),d.value==3?(i(),o("div",we,Ce)):v("",!0)])])):v("",!0),e("div",Re,[d.value==1?(i(),o("div",Ae,"*\u7EA2\u5305\u91D1\u989D\u5C06\u5728"+c(a(A).unix(a(t).sendTime).format("YYYY-MM-DD HH:mm"))+"\u5206\u5F00\u59CB\u53D1\u653E\uFF0C\u8F6C\u5165"+c(a(F)(a(n).walletAddress))+"\u5730\u5740\uFF0C\u5177\u4F53\u65F6\u95F4\u4EE5\u94FE\u4E0A\u5230\u8D26\u4E3A\u51C6",1)):v("",!0),e("div",{class:"show-luck",onClick:l[0]||(l[0]=V=>a(k).push(`/redpacket/${a(t).uuid}/showLuck`))},"\u67E5\u770B\u5927\u5BB6\u624B\u6C14 >")])])])],512)]),e("div",He,[f(N,{class:"send-red-packet",onClick:l[1]||(l[1]=V=>a(k).push("/"))},{default:M(()=>[R("\u6211\u4E5F\u8981\u53D1\u7EA2\u5305")]),_:1}),e("div",Pe,[f(b,{class:"icon",name:"logo"})])])])}}},Be=q(Ie,[["__scopeId","data-v-af62d138"]]);export{Be as default};
