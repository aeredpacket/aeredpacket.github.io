import{r,o as i,c as y,w as o,a as l,b as p,d as ee,F as G,e as f,t as A,u as x,f as se,g as t,h as ie,i as Ae,p as de,j as ce,k as $e,l as Se,m as d,n as Ie,q,s as B,v as J,T as K,B as te,x as Be,y as Ne}from"./index.51b27cd1.js";import{_ as $}from"./TokenIcon.vue_vue_type_style_index_0_scoped_7bbb7138_lang.3c67c4b4.js";import{_ as ue}from"./_plugin-vue_export-helper.cdc0426e.js";const Pe=s=>(de("data-v-4d8c2315"),s=s(),ce(),s),Te=Pe(()=>l("div",{class:"title"},"\u4EA4\u6613\u8BE6\u60C5",-1)),He={class:"body"},Ue={class:"status-text"},Le={key:0},Ee={key:1},Fe={key:2},ze={key:3},De={class:"status-icon"},Re={class:"tx"},We={key:1,class:"trade-hash"},Oe={__name:"ChainTrade",props:{tradeVisable:{type:Boolean,default:!1},status:{type:Number,default:0},tradeHash:{type:String,default:""}},emits:["update:tradeVisable"],setup(s,{emit:ae}){return(m,C)=>{const F=r("van-loading"),V=r("van-icon"),N=r("van-popup");return i(),y(N,{class:"dialog",show:s.tradeVisable,"onUpdate:show":C[1]||(C[1]=h=>Ae(tradeVisable)?tradeVisable.value=h:null),round:"","close-on-click-overlay":!1},{default:o(()=>[Te,l("div",He,[l("div",Ue,[s.status!=0?(i(),p(G,{key:0},[s.status==1?(i(),p("div",Le,"\u53D1\u9001\u4EA4\u6613\u5230\u533A\u5757\u94FE\u2026")):s.status==2?(i(),p("div",Ee,"\u7B49\u5F85\u670D\u52A1\u5668\u540C\u6B65...")):s.status==-1?(i(),p("div",Fe,"\u4E0A\u94FE\u4EA4\u6613\u53D1\u9001\u5931\u8D25")):s.status==-2?(i(),p("div",ze,"\u670D\u52A1\u5668\u540C\u6B65\u8D85\u65F6")):ee("",!0)],64)):ee("",!0)]),l("div",De,[s.status==1||s.status==2?(i(),y(F,{key:0,type:"spinner",size:"48px"})):s.status==0?(i(),y(V,{key:1,color:"#07c160",size:"40px",name:"checked"})):s.status==-1||s.status==-2?(i(),y(V,{key:2,color:"#FA5151",size:"40px",name:"clear"})):ee("",!0)]),s.tradeHash?(i(),p("div",{key:0,class:"trade-hash",onClick:C[0]||(C[0]=h=>x(ie)(s.tradeHash))},[f("\u4EA4\u6613Hash: "),l("span",Re,A(x(se)(s.tradeHash)),1),t($,{name:"copy"})])):(i(),p("div",We,"\u4EA4\u6613Hash: N/A"))])]),_:1},8,["show"])}}},je=ue(Oe,[["__scopeId","data-v-4d8c2315"]]);const E=s=>(de("data-v-dd2b19f3"),s=s(),ce(),s),qe={class:"body"},Je={class:"tools-bar"},Ke={key:0,class:"address"},Ge=E(()=>l("div",null,"\u8BF7\u8FDE\u63A5\u94B1\u5305",-1)),Me={class:"tools"},Qe={class:"token"},Xe={class:"token-symbol"},Ye={class:"amount"},Ze={style:{"margin-left":"4px"}},et=E(()=>l("svg",{class:"icon","aria-hidden":"true"},[l("use",{"xlink:href":"#icon-redPacket"})],-1)),tt={key:0};const at={class:"form-item total-amount"},lt={class:"form-item create"},ot=E(()=>l("div",{class:"content"},[l("div",null,"1: \u62FC\u624B\u6C14\u7EA2\u5305, \u9886\u53D6\u91D1\u989D\u968F\u673A, \u666E\u901A\u7EA2\u5305\u5219\u6BCF\u4E2A\u7EA2\u5305\u7684\u91D1\u989D\u5747\u76F8\u7B49\u3002"),l("div",null,"2: \u7EA2\u5305\u5230\u671F\u540E, \u5C06\u65E0\u6CD5\u88AB\u9886\u53D6, \u5269\u4F59\u91D1\u989D\u5C06\u539F\u8DEF\u9000\u8FD8\u3002"),l("div",null,"3: \u7EA2\u5305\u5230\u671F\u540E, \u667A\u80FD\u5408\u7EA6\u5C06\u81EA\u52A8\u4E3A\u5DF2\u9886\u53D6\u7528\u6237\u53D1\u653E\u4EE3\u5E01, \u5230\u8D26\u65F6\u95F4\u4EE5\u94FE\u4E0A\u5B8C\u6210\u65F6\u95F4\u4E3A\u51C6\u3002"),l("div",null,"4: \u56E0\u94FE\u4E0AGAS\u8D39\u7528, \u652F\u4ED8\u91D1\u989D\u4E00\u822C\u4F1A\u5927\u4E8E\u7EA2\u5305\u603B\u91D1\u989D\u3002"),l("div",null,"5: \u7EA2\u5305\u521B\u5EFA\u529F\u80FD, \u76EE\u524D\u652F\u6301BSC/OKC/HECO\u94FE\u3002")],-1)),nt={class:"content"},st={class:"success-icon"},it=E(()=>l("div",{class:"title"},"\u606D\u559C\uFF0C\u7EA2\u5305\u521B\u5EFA\u6210\u529F~",-1)),dt=E(()=>l("div",{class:"text"},"\u8F6C\u53D1\u9886\u53D6\u94FE\u63A5\uFF0C\u7528\u6237\u53EF\u4F7F\u7528AveAPP\u6216\u5176\u4ED6\u94B1\u5305\u7C7BAPP\u6253\u5F00\u94FE\u63A5\u75C5\u9886\u53D6\u7EA2\u5305",-1)),ct={class:"btn"},ut=E(()=>l("div",{class:"content"},[l("div",null,"\u6682\u4E0D\u652F\u6301\u6B64\u94FE\uFF0C"),l("div",null,"\u8BF7\u5207\u6362\u81F3ETH\u3001BSC\u3001OKC\u3001HECO")],-1)),rt={__name:"Index",setup(s){const ae=$e(),m=Se(),C=d(!1),F=d(!1),V=d(!1),N=d(!1),h=d(0),P=d(""),T=d(""),S=d("");d("");const M=d(""),z=d(""),re=Ie(()=>h.value==0?P.value?P.value:"0.00":T.value&&S.value?te(Number(T.value)).multipliedBy(Number(S.value)).toNumber().toString():"0.00"),k=d(!1),g=d(0),H=d(""),Q=d(!1),R=d(!1),X=d(""),le=d(!1),ve=q([{name:"\u7B80\u4F53\u4E2D\u6587",value:"zn-ch"},{name:"English",value:"en"}]);function me(n){console.log(n)}const Y=d([]),u=q({symbol:"JF",icon:"https://static.debank.com/image/bsc_token/logo_url/0x5fac926bf1e638944bb16fb5b787b5ba4bc85b0a/74d0d0f5a5fcf76ab35b89b29cb9c95e.png",amount:9999999,address:"0x227A05695F10B591731Fd925396b548a45067798",chain:"bsc",chainId:97}),D=d(!1),_e=q([{text:"5 \u5206\u949F",value:300},{text:"10 \u5206\u949F",value:600}]),U=q({text:"5 \u5206\u949F",value:300});function fe(n,e){console.log(n),Ne(n)}function pe(n){U.text=n.text,U.value=n.value,D.value=!1}async function be(){const n=m.chainId;if(n==97){Y.value=[{symbol:"JF",icon:"https://static.debank.com/image/bsc_token/logo_url/0x5fac926bf1e638944bb16fb5b787b5ba4bc85b0a/74d0d0f5a5fcf76ab35b89b29cb9c95e.png",amount:9999999,address:"0x227A05695F10B591731Fd925396b548a45067798",chain:"bsc",chainId:97}];return}let _=(await B.wallet.getWalletTokenList(m.walletAddress,B.wallet.ALLOW_CHAINS[n])).data.filter(c=>new RegExp("^0x.*$","gi").test(c.id)).map(c=>({address:c.id.toLowerCase(),tokenId:`${c.id}-${c.chain}`.toLowerCase(),chain:c.chain.toLowerCase(),symbol:c.symbol,decimals:c.decimals,icon:c.logo_url,amount:c.amount,chainId:n}));console.dir(_);let v=_.map(c=>c.tokenId),I=await B.redPacket.tokenlistcheck(v);Y.value=_.filter(c=>I.data[c.tokenId].riskScore<60)}function he(n){u.symbol=n.symbol,u.icon=n.icon,u.amount=n.amount,u.address=n.address,u.chain=n.chain,u.chainId=n.chainId,N.value=!1}async function oe(){await m.connectWallet(),await ne()}function ke(){return!0}async function ye(){k.value=!1,H.value="",g.value=1,k.value=!0;try{let n=await B.wallet.approveMaxAmount(u.address,m.redPacketContractAddress);console.log(n),V.value=!1,H.value=n.hash,g.value=0}catch{g.value=-1,await J(2e3)}finally{k.value=!1}}async function ne(){await B.wallet.isAllowanceEnough(m.redPacketContractAddress,u.address,m.walletAddress)?V.value=!1:V.value=!0}async function ge(){Q.value=!0,await we(),Q.value=!1}async function we(){if(k.value=!1,H.value="",R.value=!1,X.value="",h.value==0){if(!P.value){K.fail("\u8BF7\u8F93\u5165\u603B\u91D1\u989D");return}}else if(!T.value){K.fail("\u8BF7\u8F93\u5165\u5355\u4E2A\u91D1\u989D");return}if(!S.value){K.fail("\u8BF7\u8F93\u5165\u6570\u91CF");return}let n;if(h.value==0?n=te(Number(P.value)).toNumber():n=te(Number(T.value)).multipliedBy(Number(S.value)).toNumber(),z.value||(z.value="\u606D\u559C\u53D1\u8D22, \u5927\u5409\u5927\u5229"),!ke())return;if(await ne(),V.value){K.fail("\u8BF7\u5148Approve");return}g.value=1,k.value=!0;let _;try{let v=await B.wallet.sendRedPacket(m.redPacketContractAddress,u.address,h.value,n.toString(),S.value,U.value);console.dir(v),H.value=v.hash,_=await v.wait(),console.dir(_),H.value=_.transactionHash}catch(v){console.log(v),g.value=-1,await J(1e3),k.value=!1;return}g.value=2;try{let v=_==null?void 0:_.events,I={};for(let w=v.length-1;w>=0;w--){let b=v[w].topics.some(O=>O==="0x694af1cc8727cdd0afbdd53d9b87b69248bd490224e9dd090e788546506e076f");if(v[w].address==m.redPacketContractAddress&&b){I=v[w];break}}let c=await B.redPacket.send(u.address,u.chain,I.topics[1],_.transactionHash,U.value,z.value,u.symbol,M.value);console.dir(c),g.value=0,await J(500),k.value=!1;const W=c.data.uuid;R.value=!0,X.value=window.location.origin+"/redpacket/"+W}catch(v){console.log(v),g.value=-1,await J(1e3),k.value=!1}}return m.isConnectWallet&&be(),(n,e)=>{const _=r("van-dropdown-item"),v=r("van-dropdown-menu"),I=r("van-radio"),c=r("van-radio-group"),W=r("van-icon"),w=r("van-cell"),b=r("van-cell-group"),O=r("van-action-sheet"),L=r("van-field"),xe=r("van-picker"),Ce=r("van-popup"),vt=r("van-image"),Ve=r("van-uploader"),j=r("van-button"),Z=r("van-dialog");return i(),p(G,null,[l("div",qe,[l("div",Je,[x(m).isConnectWallet?(i(),p("div",Ke,[t($,{name:"mbox"}),t(v,null,{default:o(()=>[t(_,{title:x(se)(x(m).walletAddress),ref:"item"},null,8,["title"])]),_:1})])):(i(),p("div",{key:1,class:"address",onClick:oe},[t($,{name:"wallet"}),Ge])),l("div",Me,[t($,{name:"language",onClick:e[0]||(e[0]=a=>F.value=!0)}),t($,{name:"help",onClick:e[1]||(e[1]=a=>C.value=!0)})])]),t(c,{modelValue:h.value,"onUpdate:modelValue":e[2]||(e[2]=a=>h.value=a),direction:"horizontal",class:"type form-item"},{default:o(()=>[t(I,{name:0,"checked-color":"#ED4A4A","icon-size":"16px"},{default:o(()=>[f("\u62FC\u624B\u6C14\u7EA2\u5305")]),_:1}),t(I,{name:1,"checked-color":"#ED4A4A","icon-size":"16px"},{default:o(()=>[f("\u666E\u901A\u7EA2\u5305")]),_:1})]),_:1},8,["modelValue"]),t(b,{inset:"",class:"form-item form-normal"},{default:o(()=>[t(w,{title:"\u5E01\u79CD","is-link":"",onClick:e[3]||(e[3]=a=>N.value=!0)},{value:o(()=>[l("div",null,[t(W,{name:u.icon},null,8,["name"]),f(" "+A(u.symbol),1)])]),_:1}),t(O,{show:N.value,"onUpdate:show":e[4]||(e[4]=a=>N.value=a),title:"\u8BBE\u7F6E\u5E01\u79CD"},{default:o(()=>[l("div",Qe,[t(b,{inset:""},{default:o(()=>[(i(!0),p(G,null,Be(Y.value,a=>(i(),y(w,{key:a.address,clickable:"",onClick:mt=>he(a)},{title:o(()=>[l("div",Xe,[t(W,{class:"symbol-icon",name:u.icon},null,8,["name"]),l("span",null,A(a.symbol),1)])]),value:o(()=>[l("div",null,[l("span",null,A("\u4F59\u989D")+": "+A(a.amount),1),f("\xA0\xA0 ")])]),_:2},1032,["onClick"]))),128))]),_:1})])]),_:1},8,["show"])]),_:1}),h.value==0?(i(),y(b,{key:0,inset:"",class:"form-item form-normal"},{default:o(()=>[t(L,{label:"\u603B\u91D1\u989D","input-align":"right",placeholder:"\u8F93\u5165\u91D1\u989D",type:"number",modelValue:P.value,"onUpdate:modelValue":e[5]||(e[5]=a=>P.value=a)},{"left-icon":o(()=>[t($,{name:"pin"})]),_:1},8,["modelValue"])]),_:1})):(i(),y(b,{key:1,inset:"",class:"form-item form-normal"},{default:o(()=>[t(L,{label:"\u5355\u4E2A\u91D1\u989D","input-align":"right",placeholder:"\u8F93\u5165\u91D1\u989D",type:"number",modelValue:T.value,"onUpdate:modelValue":e[6]||(e[6]=a=>T.value=a)},{"left-icon":o(()=>[t($,{name:"pu"})]),_:1},8,["modelValue"])]),_:1})),l("div",Ye,[f(" \u53EF\u7528\u4F59\u989D"),l("span",Ze,A(u.amount+" "+u.symbol),1)]),t(b,{inset:"",class:"form-item form-normal"},{default:o(()=>[t(L,{label:"\u7EA2\u5305\u4E2A\u6570","input-align":"right",placeholder:"\u8F93\u5165\u4E2A\u6570",type:"digit",modelValue:S.value,"onUpdate:modelValue":e[7]||(e[7]=a=>S.value=a)},{"left-icon":o(()=>[et]),"right-icon":o(()=>[f("\u4E2A")]),_:1},8,["modelValue"])]),_:1}),t(b,{inset:"",class:"form-item form-normal"},{default:o(()=>[t(L,{modelValue:U.text,"onUpdate:modelValue":e[8]||(e[8]=a=>U.text=a),"is-link":"",readonly:"",name:"picker",label:"\u8FC7\u671F\u65F6\u95F4",onClick:e[9]||(e[9]=a=>D.value=!0),"input-align":"right"},null,8,["modelValue"]),t(Ce,{show:D.value,"onUpdate:show":e[11]||(e[11]=a=>D.value=a),position:"bottom"},{default:o(()=>[t(xe,{columns:_e,onCancel:e[10]||(e[10]=a=>D.value=!1),onConfirm:pe,title:"\u8BBE\u7F6E\u8FC7\u671F\u65F6\u95F4","confirm-button-text":"\u786E\u8BA4","cancel-button-text":"\u53D6\u6D88"},null,8,["columns"])]),_:1},8,["show"])]),_:1}),t(b,{inset:"",class:"form-item form-normal"},{default:o(()=>[t(Ve,{class:"uploader-box","before-read":fe,"max-size":1024*1024,"preview-image":!1,accept:"image/*"},{default:o(()=>[t(w,{class:"uploader-content","is-link":"",title:"\u7EA2\u5305\u5C01\u9762\uFF08\u9009\u586B\uFF09"},{value:o(()=>[(i(),p("div",tt," \u9009\u62E9\u56FE\u7247 "))]),_:1})]),_:1})]),_:1}),t(b,{inset:"",class:"form-item"},{default:o(()=>[t(L,{modelValue:z.value,"onUpdate:modelValue":e[12]||(e[12]=a=>z.value=a),rows:"1",autosize:"",type:"textarea",maxlength:"20",placeholder:"\u606D\u559C\u53D1\u8D22, \u5927\u5409\u5927\u5229","show-word-limit":""},null,8,["modelValue"])]),_:1}),t(b,{inset:"",class:"form-item"},{default:o(()=>[t(L,{modelValue:M.value,"onUpdate:modelValue":e[13]||(e[13]=a=>M.value=a),rows:"2",autosize:"",type:"textarea",maxlength:"500",placeholder:"\u6D3B\u52A8\u8BF4\u660E(\u9009\u586B), \u6700\u591A500\u5B57"},null,8,["modelValue"])]),_:1}),l("div",at,[f(" \u7EA2\u5305\u603B\u989D"),l("span",null,A(x(re)),1),f(A(u.symbol),1)]),l("div",lt,[x(m).isConnectWallet?(i(),p(G,{key:0},[V.value?(i(),y(j,{key:0,class:"create-btn",type:"danger",onClick:ye},{default:o(()=>[f("Approve")]),_:1})):(i(),y(j,{key:1,class:"create-btn",type:"danger",onClick:ge,loading:Q.value},{default:o(()=>[f("\u521B\u5EFA\u7EA2\u5305")]),_:1},8,["loading"]))],64)):(i(),y(j,{key:1,class:"create-btn",type:"primary",onClick:oe},{default:o(()=>[f("\u8FDE\u63A5\u94B1\u5305")]),_:1}))]),l("div",{class:"form-item history",onClick:e[14]||(e[14]=a=>x(ae).push("/history"))},"\u7EA2\u5305\u5386\u53F2")]),t(Z,{class:"help-dialog",show:C.value,"onUpdate:show":e[15]||(e[15]=a=>C.value=a),title:"\u89C4\u5219\u8BF4\u660E","confirm-button-text":"\u77E5\u9053\u4E86","close-on-click-overlay":""},{default:o(()=>[ot]),_:1},8,["show"]),t(Z,{class:"create-success-dialog",show:R.value,"onUpdate:show":e[17]||(e[17]=a=>R.value=a),"close-on-click-overlay":""},{footer:o(()=>[l("div",ct,[t(j,{class:"copy-btn",type:"primary",onClick:e[16]||(e[16]=a=>x(ie)(X.value))},{default:o(()=>[f("\u590D\u5236\u7EA2\u5305\u94FE\u63A5")]),_:1})])]),default:o(()=>[l("div",nt,[l("div",st,[t($,{name:"createSuccess"})]),it,dt])]),_:1},8,["show"]),t(O,{show:F.value,"onUpdate:show":e[18]||(e[18]=a=>F.value=a),title:"\u5207\u6362\u8BED\u8A00",actions:ve,closeable:!1,"cancel-text":"\u53D6\u6D88","close-on-click-action":"",onSelect:me},null,8,["show","actions"]),t(je,{tradeVisable:k.value,"onUpdate:tradeVisable":e[19]||(e[19]=a=>k.value=a),status:g.value,tradeHash:H.value},null,8,["tradeVisable","status","tradeHash"]),t(Z,{class:"chain-err-dialog",confirmButtonText:"\u6211\u77E5\u9053\u4E86",confirmButtonColor:"#3F80F7",show:le.value,"onUpdate:show":e[20]||(e[20]=a=>le.value=a)},{default:o(()=>[ut]),_:1},8,["show"])],64)}}},bt=ue(rt,[["__scopeId","data-v-dd2b19f3"]]);export{bt as default};
