import{T as g,d as w}from"./dayjs.min.a6334be0.js";import{_ as C}from"./TokenIcon.vuevuetypestyleindex0scoped7bbb7138lang.24971b0f.js";import{k as D,j as E,n as u,I as M,p as Y,r as I,o as d,b as n,a as e,M as P,t as o,d as l,u as s,c as R,g as p,e as $,w as O,N as W,T as j,s as z,O as A,E as S,f as F,A as G,C as q}from"./index.68bdfa0e.js";import{u as J}from"./redPacketStore.1f4dc1f2.js";import{_ as K}from"./plugin-vueexport-helper.2444895f.js";const Q=_=>(G("data-v-1a07b780"),_=_(),q(),_),U={class:"body"},X={class:"top"},Z=W('<div class="background" data-v-1a07b780><div style="--i:1;" data-v-1a07b780></div><div style="--i:2;" data-v-1a07b780></div><div style="--i:3;" data-v-1a07b780></div><div style="--i:4;" data-v-1a07b780></div><div style="--i:5;" data-v-1a07b780></div><div style="--i:6;" data-v-1a07b780></div><div style="--i:7;" data-v-1a07b780></div><div style="--i:8;" data-v-1a07b780></div><div style="--i:9;" data-v-1a07b780></div><div style="--i:10;" data-v-1a07b780></div><div style="--i:11;" data-v-1a07b780></div><div style="--i:12;" data-v-1a07b780></div><div style="--i:13;" data-v-1a07b780></div><div style="--i:14;" data-v-1a07b780></div><div style="--i:15;" data-v-1a07b780></div><div style="--i:16;" data-v-1a07b780></div><div style="--i:17;" data-v-1a07b780></div><div style="--i:18;" data-v-1a07b780></div><div style="--i:19;" data-v-1a07b780></div><div style="--i:20;" data-v-1a07b780></div><div style="--i:21;" data-v-1a07b780></div><div style="--i:22;" data-v-1a07b780></div><div style="--i:23;" data-v-1a07b780></div><div style="--i:24;" data-v-1a07b780></div><div style="--i:25;" data-v-1a07b780></div><div style="--i:26;" data-v-1a07b780></div><div style="--i:27;" data-v-1a07b780></div><div style="--i:28;" data-v-1a07b780></div><div style="--i:29;" data-v-1a07b780></div><div style="--i:30;" data-v-1a07b780></div><div style="--i:31;" data-v-1a07b780></div><div style="--i:32;" data-v-1a07b780></div><div style="--i:33;" data-v-1a07b780></div><div style="--i:34;" data-v-1a07b780></div><div style="--i:35;" data-v-1a07b780></div><div style="--i:36;" data-v-1a07b780></div></div>',1),ee={class:"info-box"},te={key:0,class:"fold-operate-fixed"},ae=Q(()=>e("span",{class:"dot"},"...",-1)),se={class:"fold-text"},oe={class:"red-packet"},ie={class:"circle-big"},de={class:"circle-small"},le={key:0,class:"card"},ne={class:"from"},ce={class:"amount"},ve={class:"congratulation"},re={class:"text"},ue={key:0,class:"logo"},ye={key:1},_e={class:"text-top"},pe={class:"from"},he={class:"congratulation"},fe={key:0,class:"front-cover"},be={class:"text-middle"},me={key:0},ke={key:1},ge={class:"text-bottom"},we={key:0,class:"award-time"},Ce={class:"bottom"},Ie={class:"logo"},Pe={__name:"ReceiveRedPacket",setup(_){const t=J(),v=D(),b=E(),m=u(!1),y=u(!0),r=u(null),h=u(null),i=u(0),f=u("--");M(async()=>{let a=h.value.scrollHeight,c=h.value.offsetHeight;a>c&&(m.value=!0),document.body.style.setProperty("--top-height",r.value.scrollHeight-10+"px"),window.onresize=()=>(console.log("\u9AD8\u5EA6"),(()=>{console.log(r.value.scrollHeight),document.body.style.setProperty("--top-height",r.value.scrollHeight-10+"px")})())});async function H(){console.log("openClick");const a=j.loading();try{await L()}catch(c){console.log(c)}finally{a.clear()}}async function L(){if(!v.isConnectWallet){if(await v.connectWallet(),!v.isConnectWallet)return;await t.getRedPacketDetail(t.uuid,v.walletAddress)}if(t.isReceived){const a=t.receiveList.find(c=>c.userAddress==v.walletAddress);f.value=a.amount,i.value=1;return}if(console.log(t.status),t.status==3)try{const a=await z.redPacket.receive(v.walletAddress,t.uuid);console.log(a),a.status==1&&a.data.status==3&&(t.isReceived=!0,f.value=a.data.receiveResult.amount,i.value=1,t.receiveList.push({transferTime:w().unix(),amount:a.data.receiveResult.amount,userAddress:a.data.receiveResult.userAddress}))}catch(a){console.log(a),i.value=2}else t.count==t.receiveList.length?i.value=2:i.value=3}async function T(){y.value=!1,await A(),document.body.style.setProperty("--top-height",r.value.scrollHeight-10+"px")}async function x(){y.value=!0,await A(),document.body.style.setProperty("--top-height",r.value.scrollHeight-10+"px")}const k=Y(()=>t.creatorAddress?t.creatorAddress.substr(-4).toLowerCase():"--");return(a,c)=>{const B=I("van-image"),N=I("van-button");return d(),n("div",U,[e("div",X,[Z,e("div",{class:"content",ref_key:"content",ref:r},[e("div",ee,[e("div",{class:P(["info",{fold:y.value}]),ref_key:"info",ref:h},[m.value&&y.value?(d(),n("div",te,[ae,e("span",{class:"fold-operate",onClick:T},o(a.$t("open")),1)])):l("",!0),e("span",se,o(s(t).title),1),y.value?l("",!0):(d(),n("span",{key:1,class:"fold-operate",onClick:x},o(a.$t("putAway")),1))],2)]),e("div",oe,[e("div",ie,[e("div",de,[i.value==1?(d(),n("div",le,[e("div",ne,[s(t).contractChain?(d(),R(g,{key:0,class:"token-icon",tokenIcon:s(S)(s(t).contractChain.toLowerCase(),s(t).contractAddress.toLowerCase())},null,8,["tokenIcon"])):l("",!0),e("span",null,o(a.$t("redPacketBelong",{user:s(k)})),1)]),e("div",ce,o(f.value+" "+s(t).symbol),1),e("div",ve,o(s(t).remark),1)])):l("",!0)])]),e("div",re,[i.value!=1?(d(),n("div",ue,[p(C,{class:"icon",name:"logo"})])):l("",!0),i.value!=1?(d(),n("div",ye,[e("div",_e,[e("div",pe,[s(t).contractChain?(d(),R(g,{key:0,class:"token-icon",tokenIcon:s(S)(s(t).contractChain.toLowerCase(),s(t).contractAddress.toLowerCase())},null,8,["tokenIcon"])):l("",!0),$(o()+" ",1),e("span",null,"*"+o(a.$t("redPacketBelong",{user:s(k)})),1)]),e("div",he,o(s(t).remark),1)]),i.value==0&&s(t).coverImage?(d(),n("div",fe,[p(B,{class:"img",fit:"contain",src:s(t).coverImage},null,8,["src"])])):l("",!0),i.value==0?(d(),n("div",{key:1,class:P(["open",s(v).language=="en"?"open-en":""]),onClick:H},o(a.$t("open")),3)):l("",!0),e("div",be,[i.value==2?(d(),n("div",me,[e("div",null,o(a.$t("handSlow")),1),e("div",null,o(a.$t("redPackIsGone")),1)])):l("",!0),i.value==3?(d(),n("div",ke,[e("div",null,o(a.$t("handSlow")),1),e("div",null,o(a.$t("redPackIsExpired")),1)])):l("",!0)])])):l("",!0),e("div",ge,[i.value==1?(d(),n("div",we,o(a.$t("distributeTime",{date:s(w).unix(s(t).sendTime).format("YYYY-MM-DD HH:mm"),address:s(F)(s(v).walletAddress)})),1)):l("",!0),e("div",{class:"show-luck",onClick:c[0]||(c[0]=V=>s(b).push(`/redpacket/${s(t).uuid}/showLuck`))},o(a.$t("seeLuckEveryone"))+" >",1)])])])],512)]),e("div",Ce,[p(N,{class:"send-red-packet",onClick:c[1]||(c[1]=V=>s(b).push("/"))},{default:O(()=>[$(o(a.$t("giveOutRedPacket")),1)]),_:1}),e("div",Ie,[p(C,{class:"icon",name:"logo"})])])])}}},Le=K(Pe,[["__scopeId","data-v-1a07b780"]]);export{Le as default};
