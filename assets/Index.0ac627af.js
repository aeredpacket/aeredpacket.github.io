import{r as v,o as i,c as k,w as n,a as l,b as f,d as ee,F as M,e as m,t as _,u as p,f as de,g as t,h as re,i as Ie,p as ve,j as me,k as Se,l as Ne,m as Pe,n as Be,q as u,s as ue,v as ae,x as R,y as G,T as j,B as te,z as Ue,A as Le}from"./index.45176f9d.js";import{_ as A}from"./TokenIcon.vuevuetypestyleindex0scoped7bbb7138lang.c5fb083f.js";import{_ as _e}from"./plugin-vueexport-helper.2444895f.js";const Fe=s=>(ve("data-v-4d8c2315"),s=s(),me(),s),Te=Fe(()=>l("div",{class:"title"},"\u4EA4\u6613\u8BE6\u60C5",-1)),ze={class:"body"},He={class:"status-text"},Ee={key:0},De={key:1},Re={key:2},je={key:3},We={class:"status-icon"},qe={class:"tx"},Je={key:1,class:"trade-hash"},Ge={__name:"ChainTrade",props:{tradeVisable:{type:Boolean,default:!1},status:{type:Number,default:0},tradeHash:{type:String,default:""}},emits:["update:tradeVisable"],setup(s,{emit:le}){return(d,$)=>{const T=v("van-loading"),N=v("van-icon"),z=v("van-popup");return i(),k(z,{class:"dialog",show:s.tradeVisable,"onUpdate:show":$[1]||($[1]=x=>Ie(tradeVisable)?tradeVisable.value=x:null),round:"","close-on-click-overlay":!1},{default:n(()=>[Te,l("div",ze,[l("div",He,[s.status!=0?(i(),f(M,{key:0},[s.status==1?(i(),f("div",Ee,"\u53D1\u9001\u4EA4\u6613\u5230\u533A\u5757\u94FE\u2026")):s.status==2?(i(),f("div",De,"\u7B49\u5F85\u670D\u52A1\u5668\u540C\u6B65...")):s.status==-1?(i(),f("div",Re,"\u4E0A\u94FE\u4EA4\u6613\u53D1\u9001\u5931\u8D25")):s.status==-2?(i(),f("div",je,"\u670D\u52A1\u5668\u540C\u6B65\u8D85\u65F6")):ee("",!0)],64)):ee("",!0)]),l("div",We,[s.status==1||s.status==2?(i(),k(T,{key:0,type:"spinner",size:"48px"})):s.status==0?(i(),k(N,{key:1,color:"#07c160",size:"40px",name:"checked"})):s.status==-1||s.status==-2?(i(),k(N,{key:2,color:"#FA5151",size:"40px",name:"clear"})):ee("",!0)]),s.tradeHash?(i(),f("div",{key:0,class:"trade-hash",onClick:$[0]||($[0]=x=>p(re)(s.tradeHash))},[m("\u4EA4\u6613Hash: "),l("span",qe,_(p(de)(s.tradeHash)),1),t(A,{name:"copy"})])):(i(),f("div",Je,"\u4EA4\u6613Hash: N/A"))])]),_:1},8,["show"])}}},Me=_e(Ge,[["__scopeId","data-v-4d8c2315"]]);const w=s=>(ve("data-v-5ad6b6f6"),s=s(),me(),s),Ke={class:"body"},Oe={class:"tools-bar"},Qe={key:0,class:"address"},Xe={class:"address-text"},Ye=w(()=>l("div",null,"\u8BF7\u8FDE\u63A5\u94B1\u5305",-1)),Ze={class:"tools"},ea={class:"token"},aa={class:"token-symbol"},ta={class:"amount"},la={style:{"margin-left":"4px"}},na=w(()=>l("svg",{class:"icon","aria-hidden":"true"},[l("use",{"xlink:href":"#icon-redPacket"})],-1)),oa={key:0};const sa={class:"form-item total-amount"},ia={class:"form-item create"},ca={class:"content"},ua=w(()=>l("div",null,"1: \u62FC\u624B\u6C14\u7EA2\u5305, \u9886\u53D6\u91D1\u989D\u968F\u673A, \u666E\u901A\u7EA2\u5305\u5219\u6BCF\u4E2A\u7EA2\u5305\u7684\u91D1\u989D\u5747\u76F8\u7B49\u3002",-1)),da=w(()=>l("div",null,"2: \u7EA2\u5305\u5230\u671F\u540E, \u5C06\u65E0\u6CD5\u88AB\u9886\u53D6, \u5269\u4F59\u91D1\u989D\u5C06\u539F\u8DEF\u9000\u8FD8\u3002",-1)),ra=w(()=>l("div",null,"3: \u7EA2\u5305\u5230\u671F\u540E, \u667A\u80FD\u5408\u7EA6\u5C06\u81EA\u52A8\u4E3A\u5DF2\u9886\u53D6\u7528\u6237\u53D1\u653E\u4EE3\u5E01, \u5230\u8D26\u65F6\u95F4\u4EE5\u94FE\u4E0A\u5B8C\u6210\u65F6\u95F4\u4E3A\u51C6\u3002",-1)),va=w(()=>l("div",null,"4: \u56E0\u94FE\u4E0AGAS\u8D39\u7528, \u652F\u4ED8\u91D1\u989D\u4E00\u822C\u4F1A\u5927\u4E8E\u7EA2\u5305\u603B\u91D1\u989D\u3002",-1)),ma={class:"content"},_a={class:"success-icon"},fa=w(()=>l("div",{class:"title"},"\u606D\u559C\uFF0C\u7EA2\u5305\u521B\u5EFA\u6210\u529F~",-1)),pa=w(()=>l("div",{class:"text"},"\u8F6C\u53D1\u9886\u53D6\u94FE\u63A5\uFF0C\u7528\u6237\u53EF\u4F7F\u7528AveAPP\u6216\u5176\u4ED6\u94B1\u5305\u7C7BAPP\u6253\u5F00\u94FE\u63A5\u75C5\u9886\u53D6\u7EA2\u5305",-1)),ha={class:"btn"},ba={class:"content"},ga=w(()=>l("div",null,"\u6682\u4E0D\u652F\u6301\u6B64\u94FE",-1)),ka={__name:"Index",setup(s){const le=Se(),d=Ne(),{t:$}=Pe(),T=Be("global"),N=u(!1),z=u(!1),x=u(!1),W=u(!1),I=u(0),P=u(""),B=u(""),S=u("");u("");const K=u(""),H=u("");console.log(T.cfg);const fe=ue(()=>I.value==0?P.value?P.value:"0.00":B.value&&S.value?te(Number(B.value)).multipliedBy(Number(S.value)).toNumber().toString():"0.00"),b=u(!1),y=u(0),U=u(""),O=u(!1),q=u(!1),Q=u(""),X=u(!1),pe=ue(()=>[{name:$("languages.zh-cn"),value:"zh-cn",color:d.language==="zh-cn"?"#9505F9":"#323233"},{name:$("languages.en"),value:"en",color:d.language==="en"?"#9505F9":"#323233"}]);function he(o){d.setLanguage(o.value)}const ne=u([]),c=ae({symbol:"JF",icon:"https://static.debank.com/image/bsc_token/logo_url/0x5fac926bf1e638944bb16fb5b787b5ba4bc85b0a/74d0d0f5a5fcf76ab35b89b29cb9c95e.png",amount:9999999,address:"0x227A05695F10B591731Fd925396b548a45067798",chain:"bsc",chainId:97}),E=u(!1),be=ae([{text:"5 \u5206\u949F",value:300},{text:"10 \u5206\u949F",value:600}]),L=ae({text:"5 \u5206\u949F",value:300});function ge(o,e){console.log(o),Le(o)}function ke(o){L.text=o.text,L.value=o.value,E.value=!1}async function ye(){d.chainId;{ne.value=[{symbol:"JF",icon:"https://static.debank.com/image/bsc_token/logo_url/0x5fac926bf1e638944bb16fb5b787b5ba4bc85b0a/74d0d0f5a5fcf76ab35b89b29cb9c95e.png",amount:9999999,address:"0x227A05695F10B591731Fd925396b548a45067798",chain:"bsc",chainId:97}];return}}function we(o){c.symbol=o.symbol,c.icon=o.icon,c.amount=o.amount,c.address=o.address,c.chain=o.chain,c.chainId=o.chainId,W.value=!1}async function oe(){await d.connectWallet(),await ie()}function se(){return T.cfg.allowChainList.map(e=>e.chainId).includes(d.chainId)?!0:(X.value=!0,!1)}async function xe(){b.value=!1,U.value="",y.value=1,b.value=!0;try{let o=await R.wallet.approveMaxAmount(c.address,d.redPacketContractAddress);console.log(o),x.value=!1,U.value=o.hash,y.value=0}catch{y.value=-1,await G(2e3)}finally{b.value=!1}}async function ie(){await R.wallet.isAllowanceEnough(d.redPacketContractAddress,c.address,d.walletAddress)?x.value=!1:x.value=!0}async function Ce(){O.value=!0,await Ve(),O.value=!1}async function Ve(){if(console.log("createRedPacket"),b.value=!1,U.value="",q.value=!1,Q.value="",I.value==0){if(!P.value){j.fail("\u8BF7\u8F93\u5165\u603B\u91D1\u989D");return}}else if(!B.value){j.fail("\u8BF7\u8F93\u5165\u5355\u4E2A\u91D1\u989D");return}if(!S.value){j.fail("\u8BF7\u8F93\u5165\u6570\u91CF");return}let o;if(I.value==0?o=te(Number(P.value)).toNumber():o=te(Number(B.value)).multipliedBy(Number(S.value)).toNumber(),H.value||(H.value="\u606D\u559C\u53D1\u8D22, \u5927\u5409\u5927\u5229"),await d.connectWallet(),!se())return;if(d.chainId!=c.chainId){j("\u7F51\u7EDC\u9519\u8BEF,\u8BF7\u5207\u6362\u81F3\u5E01\u79CD\u7684\u7F51\u7EDC");try{await R.wallet.switchNetwork(c.chainId)}catch(r){console.log(r);return}return}if(await ie(),x.value){j.fail("\u8BF7\u5148Approve");return}y.value=1,b.value=!0;let g;try{let r=await R.wallet.sendRedPacket(d.redPacketContractAddress,c.address,I.value,o.toString(),S.value,L.value);console.dir(r),U.value=r.hash,g=await r.wait(),console.dir(g),U.value=g.transactionHash}catch(r){console.log(r),y.value=-1,await G(1e3),b.value=!1;return}y.value=2;try{let r=g==null?void 0:g.events,D={};for(let C=r.length-1;C>=0;C--){let V=r[C].topics.some(Y=>Y==="0x694af1cc8727cdd0afbdd53d9b87b69248bd490224e9dd090e788546506e076f");if(r[C].address==d.redPacketContractAddress&&V){D=r[C];break}}let F=await R.redPacket.send(c.address,c.chain,D.topics[1],g.transactionHash,L.value,H.value,c.symbol,K.value);console.dir(F),y.value=0,await G(500),b.value=!1;const h=F.data.uuid;q.value=!0,Q.value=window.location.origin+"/redpacket/"+h}catch(r){console.log(r),y.value=-1,await G(1e3),b.value=!1}}d.isConnectWallet&&(se(),ye());const ce=T.cfg.allowChainList.map(o=>o.chainShow);return(o,e)=>{const g=v("van-radio"),r=v("van-radio-group"),D=v("van-icon"),F=v("van-cell"),h=v("van-cell-group"),C=v("van-action-sheet"),V=v("van-field"),Y=v("van-picker"),Ae=v("van-popup"),ya=v("van-image"),$e=v("van-uploader"),J=v("van-button"),Z=v("van-dialog");return i(),f(M,null,[l("div",Ke,[l("div",Oe,[p(d).isConnectWallet?(i(),f("div",Qe,[t(A,{name:"mbox"}),l("div",Xe,_(p(de)(p(d).walletAddress)),1)])):(i(),f("div",{key:1,class:"address",onClick:oe},[t(A,{name:"wallet"}),Ye])),l("div",Ze,[t(A,{name:"language",onClick:e[0]||(e[0]=a=>z.value=!0)}),t(A,{name:"help",onClick:e[1]||(e[1]=a=>N.value=!0)})])]),t(r,{modelValue:I.value,"onUpdate:modelValue":e[2]||(e[2]=a=>I.value=a),direction:"horizontal",class:"type form-item"},{default:n(()=>[t(g,{name:0,"checked-color":"#ED4A4A","icon-size":"16px"},{default:n(()=>[m(_(o.$t("randomAmount")),1)]),_:1}),t(g,{name:1,"checked-color":"#ED4A4A","icon-size":"16px"},{default:n(()=>[m(_(o.$t("identicalAmount")),1)]),_:1})]),_:1},8,["modelValue"]),t(h,{inset:"",class:"form-item form-normal"},{default:n(()=>[t(F,{title:"\u5E01\u79CD","is-link":"",onClick:e[3]||(e[3]=a=>W.value=!0)},{value:n(()=>[l("div",null,[t(D,{name:c.icon},null,8,["name"]),m(" "+_(c.symbol),1)])]),_:1}),t(C,{show:W.value,"onUpdate:show":e[4]||(e[4]=a=>W.value=a),title:"\u8BBE\u7F6E\u5E01\u79CD"},{default:n(()=>[l("div",ea,[t(h,{inset:""},{default:n(()=>[(i(!0),f(M,null,Ue(ne.value,a=>(i(),k(F,{key:a.address,clickable:"",onClick:wa=>we(a)},{title:n(()=>[l("div",aa,[t(D,{class:"symbol-icon",name:c.icon},null,8,["name"]),l("span",null,_(a.symbol),1)])]),value:n(()=>[l("div",null,[l("span",null,_("\u4F59\u989D")+": "+_(a.amount),1),m("\xA0\xA0 ")])]),_:2},1032,["onClick"]))),128))]),_:1})])]),_:1},8,["show"])]),_:1}),I.value==0?(i(),k(h,{key:0,inset:"",class:"form-item form-normal"},{default:n(()=>[t(V,{label:"\u603B\u91D1\u989D","input-align":"right",placeholder:"\u8F93\u5165\u91D1\u989D",type:"number",modelValue:P.value,"onUpdate:modelValue":e[5]||(e[5]=a=>P.value=a)},{"left-icon":n(()=>[t(A,{name:"pin"})]),_:1},8,["modelValue"])]),_:1})):(i(),k(h,{key:1,inset:"",class:"form-item form-normal"},{default:n(()=>[t(V,{label:"\u5355\u4E2A\u91D1\u989D","input-align":"right",placeholder:"\u8F93\u5165\u91D1\u989D",type:"number",modelValue:B.value,"onUpdate:modelValue":e[6]||(e[6]=a=>B.value=a)},{"left-icon":n(()=>[t(A,{name:"pu"})]),_:1},8,["modelValue"])]),_:1})),l("div",ta,[m(" \u53EF\u7528\u4F59\u989D"),l("span",la,_(c.amount+" "+c.symbol),1)]),t(h,{inset:"",class:"form-item form-normal"},{default:n(()=>[t(V,{label:"\u7EA2\u5305\u4E2A\u6570","input-align":"right",placeholder:"\u8F93\u5165\u4E2A\u6570",type:"digit",modelValue:S.value,"onUpdate:modelValue":e[7]||(e[7]=a=>S.value=a)},{"left-icon":n(()=>[na]),"right-icon":n(()=>[m("\u4E2A")]),_:1},8,["modelValue"])]),_:1}),t(h,{inset:"",class:"form-item form-normal"},{default:n(()=>[t(V,{modelValue:L.text,"onUpdate:modelValue":e[8]||(e[8]=a=>L.text=a),"is-link":"",readonly:"",name:"picker",label:"\u8FC7\u671F\u65F6\u95F4",onClick:e[9]||(e[9]=a=>E.value=!0),"input-align":"right"},null,8,["modelValue"]),t(Ae,{show:E.value,"onUpdate:show":e[11]||(e[11]=a=>E.value=a),position:"bottom"},{default:n(()=>[t(Y,{columns:be,onCancel:e[10]||(e[10]=a=>E.value=!1),onConfirm:ke,title:"\u8BBE\u7F6E\u8FC7\u671F\u65F6\u95F4","confirm-button-text":"\u786E\u8BA4","cancel-button-text":"\u53D6\u6D88"},null,8,["columns"])]),_:1},8,["show"])]),_:1}),t(h,{inset:"",class:"form-item form-normal"},{default:n(()=>[t($e,{class:"uploader-box","before-read":ge,"max-size":1024*1024,"preview-image":!1,accept:"image/*"},{default:n(()=>[t(F,{class:"uploader-content","is-link":"",title:"\u7EA2\u5305\u5C01\u9762\uFF08\u9009\u586B\uFF09"},{value:n(()=>[(i(),f("div",oa," \u9009\u62E9\u56FE\u7247 "))]),_:1})]),_:1})]),_:1}),t(h,{inset:"",class:"form-item"},{default:n(()=>[t(V,{modelValue:H.value,"onUpdate:modelValue":e[12]||(e[12]=a=>H.value=a),rows:"1",autosize:"",type:"textarea",maxlength:"20",placeholder:"\u606D\u559C\u53D1\u8D22, \u5927\u5409\u5927\u5229","show-word-limit":""},null,8,["modelValue"])]),_:1}),t(h,{inset:"",class:"form-item"},{default:n(()=>[t(V,{modelValue:K.value,"onUpdate:modelValue":e[13]||(e[13]=a=>K.value=a),rows:"2",autosize:"",type:"textarea",maxlength:"500",placeholder:"\u6D3B\u52A8\u8BF4\u660E(\u9009\u586B), \u6700\u591A500\u5B57"},null,8,["modelValue"])]),_:1}),l("div",sa,[m(" \u7EA2\u5305\u603B\u989D"),l("span",null,_(p(fe)),1),m(_(c.symbol),1)]),l("div",ia,[p(d).isConnectWallet?(i(),f(M,{key:0},[x.value?(i(),k(J,{key:0,class:"create-btn",type:"danger",onClick:xe},{default:n(()=>[m("Approve")]),_:1})):(i(),k(J,{key:1,class:"create-btn",type:"danger",onClick:Ce,loading:O.value},{default:n(()=>[m("\u521B\u5EFA\u7EA2\u5305")]),_:1},8,["loading"]))],64)):(i(),k(J,{key:1,class:"create-btn",type:"primary",onClick:oe},{default:n(()=>[m("\u8FDE\u63A5\u94B1\u5305")]),_:1}))]),l("div",{class:"form-item history",onClick:e[14]||(e[14]=a=>p(le).push("/history"))},"\u7EA2\u5305\u5386\u53F2")]),t(Z,{class:"help-dialog",show:N.value,"onUpdate:show":e[15]||(e[15]=a=>N.value=a),title:"\u89C4\u5219\u8BF4\u660E","confirm-button-text":"\u77E5\u9053\u4E86","close-on-click-overlay":""},{default:n(()=>[l("div",ca,[ua,da,ra,va,l("div",null,"5: \u7EA2\u5305\u521B\u5EFA\u529F\u80FD, \u76EE\u524D\u652F\u6301"+_(p(ce).join("/"))+"\u94FE\u3002",1)])]),_:1},8,["show"]),t(Z,{class:"create-success-dialog",show:q.value,"onUpdate:show":e[17]||(e[17]=a=>q.value=a),"close-on-click-overlay":""},{footer:n(()=>[l("div",ha,[t(J,{class:"copy-btn",type:"primary",onClick:e[16]||(e[16]=a=>p(re)(Q.value))},{default:n(()=>[m("\u590D\u5236\u7EA2\u5305\u94FE\u63A5")]),_:1})])]),default:n(()=>[l("div",ma,[l("div",_a,[t(A,{name:"createSuccess"})]),fa,pa])]),_:1},8,["show"]),t(C,{show:z.value,"onUpdate:show":e[18]||(e[18]=a=>z.value=a),title:o.$t("switchLang"),actions:p(pe),closeable:!1,"cancel-text":"\u53D6\u6D88","close-on-click-action":"",onSelect:he},null,8,["show","title","actions"]),t(Me,{tradeVisable:b.value,"onUpdate:tradeVisable":e[19]||(e[19]=a=>b.value=a),status:y.value,tradeHash:U.value},null,8,["tradeVisable","status","tradeHash"]),t(Z,{class:"chain-err-dialog",confirmButtonText:"\u6211\u77E5\u9053\u4E86",confirmButtonColor:"#3F80F7",show:X.value,"onUpdate:show":e[20]||(e[20]=a=>X.value=a)},{default:n(()=>[l("div",ba,[ga,l("div",null,"\u8BF7\u5207\u6362\u81F3"+_(p(ce).join("\u3001")),1)])]),_:1},8,["show"])],64)}}},Aa=_e(ka,[["__scopeId","data-v-5ad6b6f6"]]);export{Aa as default};
