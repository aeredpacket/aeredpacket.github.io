import{T as H}from"./TokenIcon.acb03625.js";import{_ as S}from"./SvgIcon.06d8d8b0.js";import{_ as O,k as j,j as G,l as Z,n as r,s as q,Q as J,R as k,q as Q,r as g,o as i,b as l,a as s,u as a,N as w,t as o,d as n,c as L,g as p,e as C,F as U,I as K,w as X,S as ee,U as te,T,v as se,J as x,V as ae,f as oe,G as ie,H as de}from"./index.8a27a68c.js";import{u as le}from"./redPacketStore.6ca3b1fe.js";import{d as V}from"./dayjs.min.d3948879.js";const ne=m=>(ie("data-v-40e0527f"),m=m(),de(),m),ce={class:"body"},ve={class:"top"},re=ee('<div class="background" data-v-40e0527f><div style="--i:1;" data-v-40e0527f></div><div style="--i:2;" data-v-40e0527f></div><div style="--i:3;" data-v-40e0527f></div><div style="--i:4;" data-v-40e0527f></div><div style="--i:5;" data-v-40e0527f></div><div style="--i:6;" data-v-40e0527f></div><div style="--i:7;" data-v-40e0527f></div><div style="--i:8;" data-v-40e0527f></div><div style="--i:9;" data-v-40e0527f></div><div style="--i:10;" data-v-40e0527f></div><div style="--i:11;" data-v-40e0527f></div><div style="--i:12;" data-v-40e0527f></div><div style="--i:13;" data-v-40e0527f></div><div style="--i:14;" data-v-40e0527f></div><div style="--i:15;" data-v-40e0527f></div><div style="--i:16;" data-v-40e0527f></div><div style="--i:17;" data-v-40e0527f></div><div style="--i:18;" data-v-40e0527f></div><div style="--i:19;" data-v-40e0527f></div><div style="--i:20;" data-v-40e0527f></div><div style="--i:21;" data-v-40e0527f></div><div style="--i:22;" data-v-40e0527f></div><div style="--i:23;" data-v-40e0527f></div><div style="--i:24;" data-v-40e0527f></div><div style="--i:25;" data-v-40e0527f></div><div style="--i:26;" data-v-40e0527f></div><div style="--i:27;" data-v-40e0527f></div><div style="--i:28;" data-v-40e0527f></div><div style="--i:29;" data-v-40e0527f></div><div style="--i:30;" data-v-40e0527f></div><div style="--i:31;" data-v-40e0527f></div><div style="--i:32;" data-v-40e0527f></div><div style="--i:33;" data-v-40e0527f></div><div style="--i:34;" data-v-40e0527f></div><div style="--i:35;" data-v-40e0527f></div><div style="--i:36;" data-v-40e0527f></div></div>',1),ue={key:0,class:"info-box"},fe={key:0,class:"fold-operate-fixed"},ye=ne(()=>s("span",{class:"dot"},"...",-1)),_e={class:"fold-text"},pe={class:"red-packet"},me={class:"circle-big"},he={class:"circle-small"},ke={key:0,class:"card"},ge={class:"from"},we={class:"amount"},Ce={class:"congratulation"},be={class:"text"},Ie={key:0,class:"logo"},$e={key:1},Pe={class:"text-top"},Re={class:"from"},Ae={class:"congratulation"},He={key:0,class:"front-cover"},Se={class:"packer-btn packer-btn-behind",style:{transform:"translateZ(-4px)"}},Le={class:"packer-btn packer-btn-front"},Te={class:"text-middle"},xe={key:0},Ve={key:1},Be={class:"text-bottom"},Ne={key:0,class:"award-time"},De={class:"bottom"},We={class:"logo"},Ye={__name:"ReceiveRedPacket",setup(m){const e=le(),v=j(),b=G(),{t:B}=Z(),I=r(!1),u=r(!0),f=r(null),y=r(null),_=r(!1),d=r(0),h=r("--");q(()=>{e.getRedPacketDetail(),$()}),J(()=>e.title,async(t,c)=>{$()});async function $(){if(!e.title)return;await k();let t=y.value.scrollHeight,c=y.value.offsetHeight;console.log(y.value.scrollHeight),console.log(y.value.offsetHeight),t>c&&(I.value=!0),document.body.style.setProperty("--top-height",f.value.scrollHeight-10+"px"),window.onresize=()=>(console.log("\u9AD8\u5EA6"),(()=>{document.body.style.setProperty("--top-height",f.value.scrollHeight-10+"px")})())}async function N(){u.value=!1,await k(),document.body.style.setProperty("--top-height",f.value.scrollHeight-10+"px")}async function D(){u.value=!0,await k(),document.body.style.setProperty("--top-height",f.value.scrollHeight-10+"px")}async function W(){te([e.coverImage])}async function Y(){console.log("openClick");let t;if(v.walletAddress?t=T.loading():t=T.fail(B("connectWalletWarn")),!_.value){_.value=!0;try{await z()}catch(c){console.log(c)}finally{t.clear(),_.value=!1}}}async function z(){if(!v.isConnectWallet){if(await v.connectWallet(),!v.isConnectWallet)return;await e.getRedPacketDetail(e.uuid,v.walletAddress)}if(e.isReceived){const t=e.receiveList.find(c=>c.userAddress==v.walletAddress);h.value=t.amount,d.value=1;return}if(console.log(e.status),e.status==3)try{const t=await se.redPacket.receive(v.walletAddress,e.uuid);console.log(t),t.status==1&&t.data.status==3&&(e.isReceived=!0,h.value=t.data.receiveResult.amount,d.value=1,e.receiveList.push({transferTime:V().unix(),amount:t.data.receiveResult.amount,userAddress:t.data.receiveResult.userAddress}))}catch(t){console.log(t),d.value=2}else e.count==e.receiveList.length?d.value=2:d.value=3}const P=Q(()=>e.creatorAddress?e.creatorAddress.substr(-4).toLowerCase():"--");return(t,c)=>{const E=g("van-image"),F=g("van-icon"),M=g("van-button");return i(),l("div",ce,[s("div",ve,[re,s("div",{class:"content",ref_key:"content",ref:f},[a(e).title?(i(),l("div",ue,[s("div",{class:w(["info",{fold:u.value}]),ref_key:"info",ref:y},[I.value&&u.value?(i(),l("div",fe,[ye,s("span",{class:"fold-operate",onClick:N},o(t.$t("expand")),1)])):n("",!0),s("span",_e,o(a(e).title),1),u.value?n("",!0):(i(),l("span",{key:1,class:"fold-operate",onClick:D},o(t.$t("putAway")),1))],2)])):n("",!0),s("div",pe,[s("div",me,[s("div",he,[d.value==1?(i(),l("div",ke,[s("div",ge,[a(e).contractChain?(i(),L(H,{key:0,class:"token-icon",tokenIcon:a(x)(a(e).contractChain.toLowerCase(),a(e).contractAddress.toLowerCase())},null,8,["tokenIcon"])):n("",!0),s("span",null,o(t.$t("redPacketBelong",{user:a(P)})),1)]),s("div",we,o(h.value+" "+a(e).symbol),1),s("div",Ce,o(a(e).remark),1)])):n("",!0)])]),s("div",be,[d.value!=1?(i(),l("div",Ie,[p(S,{class:"icon",name:"logo"})])):n("",!0),d.value!=1?(i(),l("div",$e,[s("div",Pe,[s("div",Re,[a(e).contractChain?(i(),L(H,{key:0,class:"token-icon",tokenIcon:a(x)(a(e).contractChain.toLowerCase(),a(e).contractAddress.toLowerCase())},null,8,["tokenIcon"])):n("",!0),C(o()+" ",1),s("span",null,"*"+o(t.$t("redPacketBelong",{user:a(P)})),1)]),s("div",Ae,o(a(e).remark),1)]),d.value==0&&a(e).coverImage?(i(),l("div",He,[p(E,{class:"img",fit:"contain",src:a(e).coverImage,onClick:W},null,8,["src"])])):n("",!0),d.value==0&&!_.value?(i(),l("div",{key:1,class:w(["open",a(v).language=="en"?"open-en":""]),onClick:Y},o(t.$t("open")),3)):d.value==0&&_.value?(i(),l("div",{key:2,class:w(["anim-rotate packer-btn-pos",a(v).language=="en"?"open-en":""])},[s("div",Se,o(t.$t("open")),1),(i(),l(U,null,K(7,(R,A)=>s("div",{class:"packer-btn-middle",key:A,style:ae({transform:`translateZ(${A-3}px)`})},null,4)),64)),s("div",Le,o(t.$t("open")),1)],2)):n("",!0),s("div",Te,[d.value==2?(i(),l("div",xe,[s("div",null,o(t.$t("handSlow")),1),s("div",null,o(t.$t("redPackIsGone")),1)])):n("",!0),d.value==3?(i(),l("div",Ve,[s("div",null,o(t.$t("handSlow")),1),s("div",null,o(t.$t("redPackIsExpired")),1)])):n("",!0)])])):n("",!0),s("div",Be,[d.value==1?(i(),l("div",Ne,o(t.$t("distributeTime",{date:a(V).unix(a(e).sendTime+a(e).endTime).format("YYYY-MM-DD HH:mm"),address:a(oe)(a(v).walletAddress)})),1)):n("",!0),s("div",{class:"show-luck",onClick:c[0]||(c[0]=R=>a(b).push(`/redpacket/${a(e).uuid}/showLuck`))},[C(o(t.$t("seeLuckEveryone"))+" ",1),p(F,{name:"arrow"})])])])])],512)]),s("div",De,[p(M,{class:"send-red-packet",onClick:c[1]||(c[1]=R=>a(b).push("/"))},{default:X(()=>[C(o(t.$t("giveOutRedPacket")),1)]),_:1}),s("div",We,[p(S,{class:"icon",name:"logo"})])])])}}},je=O(Ye,[["__scopeId","data-v-40e0527f"]]);export{je as default};
