import{T as q}from"./TokenIcon.b777dd2d.js";import{m as O,j as U,k as W,l as z,n as m,p as L,q as D,r as p,o as u,b as f,g,a as o,t as _,F as T,E as I,u as r,w as C,K,c as A,x as P,f as G,B as H,d as J,T as $,s as w}from"./index.049785be.js";import{_ as Q}from"./plugin-vueexport-helper.2444895f.js";const X={class:"content"},Y={class:"p-16"},Z={class:"network"},ee={class:"network-list"},te=["onClick"],se={class:"item-left"},oe={class:"left-content"},ae={class:"token-name"},ne={class:"token-address"},le={class:"item-right"},ie={class:"item-right-left"},ce={class:"qty"},re={class:"amount"},de={class:"item-right-right"},ue={__name:"SelectToken",setup(_e){const B=O("global"),N=U(),c=W(),{t:S}=z(),b=m([]),v=m([]),d=m(""),V=L(()=>d.value?d.value.startsWith("0x")?v.value.filter(e=>e.address==d):v.value.filter(e=>e.symbol.indexOf(d.value.toLowerCase())>-1):v.value),h={text:S("all"),value:"all",isAllow:!0},k=m({text:h.text,value:h.value,isAllow:h.isAllow}),x=L(()=>{let e=[h];for(let a of b.value){let l=B.cfg.allowChainList.some(n=>n.chain==a.chain),i={text:a.chain.toUpperCase(),value:a.chain,isAllow:l};e.push(i)}return e});async function F(e){!e.isAllow||k.value.value!=e.value&&(k.value=e,y())}async function y(){let e=[];const a=$.loading({message:"Loading...",forbidClick:!0,duration:0});k.value.value=="all"?e=await w.debank.getAllTokenList(c.walletAddress):e=await w.debank.getTokenList(c.walletAddress,k.value.value);let l=e.data.filter(t=>new RegExp("^0x.*$","gi").test(t.id)).map(t=>({address:t.id.toLowerCase(),tokenId:`${t.id}-${t.chain}`.toLowerCase(),chain:t.chain.toLowerCase(),symbol:t.symbol,decimals:t.decimals,icon:t.logo_url,amount:t.amount,price:t.price})),i=l.map(t=>t.tokenId),n=await w.redPacket.tokenlistcheck(i);a.clear(),v.value=l.filter(t=>n.data[t.tokenId].riskScore<60)}async function E(e){const a=$.loading({message:"Loading...",forbidClick:!0,duration:0});let l=await w.debank.getChainList(e);a.clear();let i=l.data;if(!i)return[];b.value=i.map(n=>({chain:n.id,cahinId:n.community_id,icon:n.logo_url,address:n.wrapped_token_id}))}function M(e){c.token=e,N.push("/")}async function R(){c.isConnectWallet&&(await E(c.walletAddress),await y())}return D(()=>{console.log("onMounted"),R()}),(e,a)=>{const l=p("van-search"),i=p("van-icon"),n=p("van-cell"),t=p("van-list");return u(),f("div",null,[g(l,{modelValue:d.value,"onUpdate:modelValue":a[0]||(a[0]=s=>d.value=s),shape:"round","show-action":"",placeholder:e.$t("searchTokenContractOrName"),"action-text":e.$t("cancel")},null,8,["modelValue","placeholder","action-text"]),o("div",X,[o("div",Y,_(e.$t("myAssets")),1),o("div",Z,[o("ul",ee,[(u(!0),f(T,null,I(r(x),s=>(u(),f("li",{class:K(k.value.value==s.value?"network-selected":""),onClick:j=>F(s)},_(s.text),11,te))),256))])]),o("div",null,[g(t,{"finished-text":e.$t("noMore"),class:"token-list"},{default:C(()=>[(u(!0),f(T,null,I(r(V),s=>(u(),A(n,{class:"item",key:s,onClick:j=>M(s)},{title:C(()=>[o("div",se,[g(q,{class:"token-icon",tokenIcon:s.icon,chainIcon:r(P)(s.chain)},null,8,["tokenIcon","chainIcon"]),o("div",oe,[o("div",ae,_(s.symbol),1),o("div",ne,_(r(G)(s.address)),1)])])]),value:C(()=>[o("div",le,[o("div",ie,[o("div",ce,_(s.amount),1),o("div",re,"$"+_(r(H)(s.amount).multipliedBy(s.price).toFixed(2)),1)]),o("div",de,[r(c).token&&r(c).token.symbol==s.symbol?(u(),A(i,{key:0,name:"success",color:"#3F80F7"})):J("",!0)])])]),_:2},1032,["onClick"]))),128))]),_:1},8,["finished-text"])])])])}}},me=Q(ue,[["__scopeId","data-v-0dbb9523"]]);export{me as default};
